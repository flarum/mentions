{"version":3,"file":"forum.js","mappings":"MACA,IAAIA,EAAsB,CCA1BA,EAAyBC,IACxB,IAAIC,EAASD,GAAUA,EAAOE,WAC7B,IAAOF,EAAiB,QACxB,IAAM,EAEP,OADAD,EAAoBI,EAAEF,EAAQ,CAAEG,EAAGH,IAC5BA,GCLRF,EAAwB,CAACM,EAASC,KACjC,IAAI,IAAIC,KAAOD,EACXP,EAAoBS,EAAEF,EAAYC,KAASR,EAAoBS,EAAEH,EAASE,IAC5EE,OAAOC,eAAeL,EAASE,EAAK,CAAEI,YAAY,EAAMC,IAAKN,EAAWC,MCJ3ER,EAAwB,CAACc,EAAKC,IAAUL,OAAOM,UAAUC,eAAeC,KAAKJ,EAAKC,GCClFf,EAAyBM,IACH,oBAAXa,QAA0BA,OAAOC,aAC1CV,OAAOC,eAAeL,EAASa,OAAOC,YAAa,CAAEC,MAAO,WAE7DX,OAAOC,eAAeL,EAAS,aAAc,CAAEe,OAAO,M,sRCLvD,MAAM,EAA+BC,OAAOC,IAAIV,IAAI,OAAQ,iBCAtD,EAA+BS,OAAOC,IAAIV,IAAI,OAAQ,a,aCA5D,MAAM,EAA+BS,OAAOC,IAAIV,IAAI,OAAQ,uBCAtD,EAA+BS,OAAOC,IAAIV,IAAI,OAAQ,oC,aCA5D,MAAM,EAA+BS,OAAOC,IAAIV,IAAI,OAAQ,yB,aCA5D,MAAM,EAA+BS,OAAOC,IAAIV,IAAI,OAAQ,gC,aCA5D,MAAM,EAA+BS,OAAOC,IAAIV,IAAI,OAAQ,gC,aCA5D,MAAM,EAA+BS,OAAOC,IAAIV,IAAI,OAAQ,sC,aCA5D,MAAM,EAA+BS,OAAOC,IAAIV,IAAI,OAAQ,0B,aCA5D,MAAM,EAA+BS,OAAOC,IAAIV,IAAI,OAAQ,kC,aCA5D,MAAM,EAA+BS,OAAOC,IAAIV,IAAI,OAAQ,2B,aCA5D,MAAM,EAA+BS,OAAOC,IAAIV,IAAI,OAAQ,0B,aCA5D,MAAM,EAA+BS,OAAOC,IAAIV,IAAI,OAAQ,4B,aCA5D,MAAM,EAA+BS,OAAOC,IAAIV,IAAI,OAAQ,2B,aCA5D,SAASW,EAAQf,GAGf,OAAOe,EAAU,mBAAqBL,QAAU,iBAAmBA,OAAOM,SAAW,SAAUhB,GAC7F,cAAcA,CAChB,EAAI,SAAUA,GACZ,OAAOA,GAAK,mBAAqBU,QAAUV,EAAEiB,cAAgBP,QAAUV,IAAMU,OAAOH,UAAY,gBAAkBP,CACpH,EAAGe,EAAQf,EACb,CCPA,SAASkB,EAAgBC,EAAGC,EAAGC,GAC7B,OAAQD,ECAV,SAAuBC,GACrB,IAAIC,ECFN,SAAqBD,GACnB,GAAI,UAAYN,EAAQM,KAAOA,EAAG,OAAOA,EACzC,IAAIF,EAAIE,EAAEX,OAAOa,aACjB,QAAI,IAAWJ,EAAG,CAChB,IAAIG,EAAIH,EAAEV,KAAKY,EAAGD,UAClB,GAAI,UAAYL,EAAQO,GAAI,OAAOA,EACnC,MAAM,IAAIE,UAAU,+CACtB,CACA,OAAyBC,OAAiBJ,EAC5C,CDPUE,CAAYF,GACpB,MAAO,UAAYN,EAAQO,GAAKA,EAAIA,EAAI,EAC1C,CDHcI,CAAcN,MAAOD,EAAIlB,OAAOC,eAAeiB,EAAGC,EAAG,CAC/DR,MAAOS,EACPlB,YAAY,EACZwB,cAAc,EACdC,UAAU,IACPT,EAAEC,GAAKC,EAAGF,CACjB,CGRA,MAAM,EAA+BN,OAAOC,IAAIV,IAAI,OAAQ,oC,aCC5D,SAASyB,EAAQV,EAAGC,GAAK,IAAIC,EAAIpB,OAAO6B,KAAKX,GAAI,GAAIlB,OAAO8B,sBAAuB,CAAE,IAAI/B,EAAIC,OAAO8B,sBAAsBZ,GAAIC,IAAMpB,EAAIA,EAAEgC,OAAO,SAAUZ,GAAK,OAAOnB,OAAOgC,yBAAyBd,EAAGC,GAAGjB,UAAY,IAAKkB,EAAEa,KAAKC,MAAMd,EAAGrB,EAAI,CAAE,OAAOqB,CAAG,CAC9P,SAASe,EAAcjB,GAAK,IAAK,IAAIC,EAAI,EAAGA,EAAIiB,UAAUC,OAAQlB,IAAK,CAAE,IAAIC,EAAI,MAAQgB,UAAUjB,GAAKiB,UAAUjB,GAAK,CAAC,EAAGA,EAAI,EAAIS,EAAQ5B,OAAOoB,IAAI,GAAIkB,QAAQ,SAAUnB,GAAKF,EAAgBC,EAAGC,EAAGC,EAAED,GAAK,GAAKnB,OAAOuC,0BAA4BvC,OAAOwC,iBAAiBtB,EAAGlB,OAAOuC,0BAA0BnB,IAAMQ,EAAQ5B,OAAOoB,IAAIkB,QAAQ,SAAUnB,GAAKnB,OAAOC,eAAeiB,EAAGC,EAAGnB,OAAOgC,yBAAyBZ,EAAGD,GAAK,EAAI,CAAE,OAAOD,CAAG,CAEva,MAAMuB,UAA8B,KACjD,WAAAzB,CAAY0B,EAAQC,QACL,IAATA,IACFA,EAAO,GAGTD,EAAOC,KAAOR,EAAcA,EAAc,CAAC,EAAGO,EAAOC,MAAQ,CAAC,GAAI,CAAC,EAAG,CACpEC,MAFY,KAIdC,MAAMH,EAAQC,EAJA,GAKhB,CACA,QAAIG,GACF,MAAO,OACT,EAEFlC,OAAOC,IAAIkC,IAAI,kBAAmB,oCAAqCN,GCnBvE,MAAM,EAA+B7B,OAAOC,IAAIV,IAAI,OAAQ,0B,aCO7C,MAAM6C,UAAyB,KAC5C,MAAAC,CAAOC,GACLL,MAAMI,OAAOC,GACbC,KAAKC,MAAQ,IAAIX,EAAsB,CACrCV,OAAQ,CACNsB,cAAeF,KAAKG,MAAMC,KAAKC,MAEjCC,KAAM,WAERN,KAAKC,MAAMM,SACb,CACA,SAAAC,GACE,MAAO,kBACT,CACA,KAAAC,GACE,OAAO,eAAeC,MAAM,2CAC9B,CACA,OAAAC,GACE,OAAOC,EAAE,IAAK,KAAMA,EAAE,MAAO,CAC3BJ,UAAW,cACVR,KAAKC,MAAMY,mBAAqBD,EAAE,IAAkB,MAAQA,EAAE,IAAK,KAAMA,EAAE,KAAM,CAClFJ,UAAW,sFACVR,KAAKC,MAAMa,WAAWC,IAAIvB,GAAQA,EAAKwB,MAAMD,IAAIE,GAASL,EAAE,KAAM,CACnE,cAAeK,EAAMC,UACpBN,EAAE,IAAa,CAChBR,KAAMa,EACNE,QAAS,IAAM,UAAUC,gBACjBpB,KAAKC,MAAMoB,WAAaT,EAAE,MAAO,CACzCJ,UAAW,gBACVI,EAAE,IAAM,CACTJ,UAAW,kBACVI,EAAE,MAAO,CACVJ,UAAW,cACVI,EAAE,IAAQ,CACXJ,UAAW,uBACXW,QAAS,IAAMnB,KAAKC,MAAMqB,WAC1BC,QAASvB,KAAKC,MAAMuB,iBACnB,eAAed,MAAM,2DAC1B,EAEFjD,OAAOC,IAAIkC,IAAI,kBAAmB,oCAAqCC,GC/CvE,MAAM,EAA+BpC,OAAOC,IAAIV,IAAI,OAAQ,kC,aCErD,SAASyE,EAAcrB,EAAMsB,EAAUC,GAC5C,OAAO,IAAIC,QAAQC,IACjB,MAAMC,EAAU,mBAAmBC,YAAY,QAAQC,YAAY5B,GAAQ,IAKtEsB,EAASO,OAAOtB,YACnBe,EAASQ,KAAK/B,MAAMgC,gBAAkBL,GAExC,MAAMM,EAAiBV,EAASW,OAAOC,oBAAoB,GACrDC,EAAYb,EAASO,OAAOtB,UAAU6B,MAAM,EAAGJ,GAC/CK,EAAwC,GAApBF,EAAUrD,OAAc,EAAI,EAAIqD,EAAUG,MAAM,cAAc,GAAGxD,OAI3F,OAHAwC,EAASW,OAAOM,eAAeC,MAAMH,GAAmBI,KAAK,OAE7DlB,EAAQ,KAAOG,EAAUH,EAAMmB,OAAOC,QAAQ,MAAO,QAAU,OAASjB,IAAU,GAC3ED,EAAQH,IAEnB,CACe,SAAST,EAAMb,EAAMuB,GAClC,OAAI,aAAaqB,YAAY,6CAA+C,aAAad,KAAK/B,MAAMC,KAAK6C,eAAiB7C,EAAK6C,aAGtHxB,EAAcrB,EAAM,aAAcuB,GAKlC,gBAA+BtE,KAAK+C,EAAK6C,cAAcC,KAAKxB,GAAYD,EAAcrB,EAAMsB,EAAUC,GAEjH,CACAlE,OAAOC,IAAIkC,IAAI,kBAAmB,oBAAqBqB,GCjCvD,MAAM,EAA+BxD,OAAOC,IAAIV,IAAI,OAAQ,mB,aCI7C,MAAMmG,UAAwB,KAC3C,WAAAtF,CAAYuC,GACVV,QACAM,KAAKI,KAAOA,CACd,CACA,IAAAgD,GACE,OAAOxC,EAAE,SAAU,CACjBJ,UAAW,yBACXb,KAAM,SACNwB,QAAS,KACPF,EAAMjB,KAAKI,KAAMJ,KAAKW,WAEvBC,EAAE,IAAM,CACTyC,KAAM,oBACN7C,UAAW,gBACT,eAAeE,MAAM,2CAC3B,CACA,IAAA4C,CAAKC,EAAMC,GACT,MAAMC,EAAQzD,KAAK0D,IAAIJ,OACjBK,EAAeF,EAAMG,eAAeC,SAC1CJ,EAAMK,IAAI,OAAQP,EAAOI,EAAaJ,MAAMO,IAAI,MAAON,EAAMG,EAAaH,KAC1ExD,KAAK+D,YAAc/D,KAAKgE,KAAKC,KAAKjE,MAClC0D,EAAEQ,UAAUC,GAAG,UAAWnE,KAAK+D,YACjC,CACA,SAAAK,CAAUb,EAAMC,GACd,MAAMC,EAAQzD,KAAK0D,IACnB1D,KAAKsD,KAAKC,EAAMG,EAAEW,QAAQC,YAAcd,EAAMC,EAAMc,cAAgB,EACtE,CACA,OAAAC,CAAQC,EAAOC,GACb,MAAMjB,EAAQzD,KAAK0D,IACnB1D,KAAKsD,KAAKmB,EAAQhB,EAAMkB,aAAcjB,EAAEW,QAAQC,YAAcI,EAAS,EACzE,CACA,IAAAV,GACEhE,KAAK0D,IAAIM,OACTN,EAAEQ,UAAUU,IAAI,UAAW5E,KAAK+D,YAClC,ECpCa,SAASc,EAAa3C,GACnC,MAAM4C,EAAYT,OAAOU,eACzB,IAAKD,EAAUE,YAAa,CAC1B,MAAMC,EAAQH,EAAUI,WAAW,GAC7BC,EAASF,EAAMG,wBACrB,GAAIlD,EAAK,KAAOiD,GAAUzB,EAAE2B,SAASnD,EAAK,GAAIiD,GAAS,CACrD,MAAMG,EAAQ5B,EAAE,SAAS6B,OAAON,EAAMO,iBAgBtC,OAbAF,EAAMG,KAAK,aAAaC,YAAY,WAClC,OAAO1F,KAAK2F,GACd,GAGAL,EAAMG,KAAK,OAAOC,YAAY,WAC5B,MAAO,OAAOE,OAAO5F,KAAK6F,IAAK,IACjC,GAGAP,EAAMG,KAAK,KAAKC,YAAY,WAC1B,MAAO,IAAIE,OAAO5F,KAAK8F,UAAW,MAAMF,OAAO5F,KAAK+F,KAAM,IAC5D,GACOT,EAAMU,MACf,CACF,CACA,MAAO,EACT,CDYAvI,OAAOC,IAAIkC,IAAI,kBAAmB,kCAAmCuD,GCXrE1F,OAAOC,IAAIkC,IAAI,kBAAmB,2BAA4BiF,GC9B9D,MAAM,EAA+BpH,OAAOC,IAAIV,IAAI,OAAQ,sC,aCA5D,MAAM,EAA+BS,OAAOC,IAAIV,IAAI,OAAQ,oC,aCA5D,MAAM,EAA+BS,OAAOC,IAAIV,IAAI,OAAQ,mC,aCA5D,MAAM,GAA+BS,OAAOC,IAAIV,IAAI,OAAQ,iCCE7C,MAAMiJ,WAA6B,KAChD,WAAApI,GACE6B,SAAST,WACTnB,EAAgBkC,KAAM,QAAS,IAC/BlC,EAAgBkC,KAAM,UAAU,GAChClC,EAAgBkC,KAAM,QAAS,GAC/BlC,EAAgBkC,KAAM,qBAAqB,EAC7C,CACA,IAAAoD,GACE,OAAOxC,EAAE,KAAM,CACbJ,UAAW,kCACVR,KAAKgB,MAAMD,IAAImF,GAAQtF,EAAE,KAAM,KAAMsF,IAC1C,CACA,IAAA5C,CAAKC,EAAMC,GACTxD,KAAK0D,IAAIJ,OAAOQ,IAAI,CAClBP,KAAMA,EAAO,KACbC,IAAKA,EAAM,OAEbxD,KAAKmG,QAAS,CAChB,CACA,IAAAnC,GACEhE,KAAK0D,IAAIM,OACThE,KAAKmG,QAAS,CAChB,CACA,QAAAC,CAASC,GACPrG,KAAKsG,mBAAoB,EACzBtG,KAAKuG,SAASvG,KAAKwG,MAAQH,GAAO,GAClCI,aAAazG,KAAK0G,0BAClB1G,KAAK0G,yBAA2BC,WAAW,IAAM3G,KAAKsG,mBAAoB,EAAO,IACnF,CACA,QAAAM,GACE5G,KAAK0D,EAAE,MAAMmD,GAAG7G,KAAKwG,OAAOf,KAAK,UAAUqB,OAC7C,CACA,QAAAP,CAASC,EAAOO,GACd,GAAI/G,KAAKsG,oBAAsBS,EAAc,OAC7C,MAAMC,EAAYhH,KAAK0D,IACjBuD,EAASD,EAAUvB,KAAK,MAC9B,IAAIyB,EAAcV,EACdU,EAAc,EAChBA,EAAcD,EAAO/H,OAAS,EACrBgI,GAAeD,EAAO/H,SAC/BgI,EAAc,GAEhBlH,KAAKwG,MAAQU,EACb,MAAMC,EAAQF,EAAOG,YAAY,UAAUP,GAAGK,GAAaG,SAAS,UACpE,GAAIN,EAAc,CAChB,MAAMO,EAAiBN,EAAU1C,YAC3BiD,EAAcP,EAAUnD,SAASL,IACjCgE,EAAiBD,EAAcP,EAAUzC,cACzCkD,EAAUN,EAAMtD,SAASL,IACzBkE,EAAaD,EAAUN,EAAM5C,cACnC,IAAID,EACAmD,EAAUF,EACZjD,EAAYgD,EAAiBC,EAAcE,EAAUE,SAASX,EAAUlD,IAAI,eAAgB,IACnF4D,EAAaF,IACtBlD,EAAYgD,EAAiBE,EAAiBE,EAAaC,SAASX,EAAUlD,IAAI,kBAAmB,UAE9E,IAAdQ,GACT0C,EAAUY,MAAK,GAAMC,QAAQ,CAC3BvD,aACC,IAEP,CACF,EChEF,SAASwD,GAAyB/J,EAAGE,GACnC,GAAI,MAAQF,EAAG,MAAO,CAAC,EACvB,IAAInB,EACFoB,EACAE,ECLJ,SAAuCF,EAAGD,GACxC,GAAI,MAAQC,EAAG,MAAO,CAAC,EACvB,IAAIC,EAAI,CAAC,EACT,IAAK,IAAI8J,KAAK/J,EAAG,GAAI,CAAC,EAAEZ,eAAeC,KAAKW,EAAG+J,GAAI,CACjD,IAAK,IAAMhK,EAAEiK,QAAQD,GAAI,SACzB9J,EAAE8J,GAAK/J,EAAE+J,EACX,CACA,OAAO9J,CACT,CDHQgK,CAA6BlK,EAAGE,GACtC,GAAIpB,OAAO8B,sBAAuB,CAChC,IAAIoJ,EAAIlL,OAAO8B,sBAAsBZ,GACrC,IAAKC,EAAI,EAAGA,EAAI+J,EAAE7I,OAAQlB,IAAKpB,EAAImL,EAAE/J,IAAK,IAAMC,EAAE+J,QAAQpL,IAAM,CAAC,EAAEsL,qBAAqB7K,KAAKU,EAAGnB,KAAOsB,EAAEtB,GAAKmB,EAAEnB,GAClH,CACA,OAAOsB,CACT,CDwDAT,OAAOC,IAAIkC,IAAI,kBAAmB,uCAAwCqG,IGnE1E,MAAM,GAA+BxI,OAAOC,IAAIV,IAAI,OAAQ,oB,eCA5D,MAAM,GAA+BS,OAAOC,IAAIV,IAAI,OAAQ,0B,eCC5D,MAAMmL,GAAY,CAAC,eAGJ,MAAMC,WAA6B,MAChD,IAAAhF,CAAKrD,GACH,MAAMsI,EAAcrI,KAAKG,OACvB,YACE4B,GACEsG,EACJlI,EAAQ2H,GAAyBO,EAAaF,IAC1C3H,EAAY,KAAU,uBAAwB,cAAe,oBAAoBoF,OAAO7D,EAAYpC,SAC1G,OAAOiB,EAAE,SAAU/D,OAAOyL,OAAO,CAC/B9H,UAAWA,EACXb,KAAM,UACLQ,GAAQS,EAAE,OAAQ,CACnBJ,UAAW,uBACVT,EAAMwI,UACX,EAEF9K,OAAOC,IAAIkC,IAAI,kBAAmB,wCAAyCwI,IClB3E,MAAM,GAAY,CAAC,WAEJ,MAAMI,GACnB,WAAA3K,CAAY4K,GACV3K,EAAgBkC,KAAM,oBAAgB,GAMtClC,EAAgBkC,KAAM,UAAW,CAAC,GAClClC,EAAgBkC,KAAM,QAAS,MAC/BlC,EAAgBkC,KAAM,WAAY,IAClClC,EAAgBkC,KAAM,oBAAqB,CAAC,GAK5ClC,EAAgBkC,KAAM,SAAU0I,UAC9B,IAAK1I,KAAK2I,OAAS3I,KAAK2I,MAAMzJ,QAAU,EAAG,OAC3C,MAAM0J,EAAa5I,KAAK2I,MAAME,cAC9B,IAAI7I,KAAK8I,SAASC,SAASH,GAA3B,CACA,IAAK,MAAM7G,KAAe/B,KAAKgJ,aAC7B,IAAK,MAAMC,WAAelH,EAAYmH,OAAON,GACtC5I,KAAKmJ,QAAQpH,EAAYpC,QAAQyJ,IAAIH,EAAM5I,OAC9CL,KAAKmJ,QAAQpH,EAAYpC,QAAQ0J,IAAIJ,EAAM5I,KAAM4I,GAKvD,OADAjJ,KAAK8I,SAAShK,KAAK8J,GACZhH,QAAQC,SAT+B,IAWhD7B,KAAKyI,kBAAoBA,CAC3B,CACA,IAAAa,CAAKN,GACHhJ,KAAK2I,MAAQ,KACb3I,KAAKgJ,aAAeA,EACpB,IAAK,MAAMjH,KAAe/B,KAAKgJ,aAC7BhJ,KAAKmJ,QAAQpH,EAAYpC,QAAU,IAAI4J,IAAIxH,EAAYyH,iBAAiBzI,IAAI0I,GAAU,CAACA,EAAOpJ,KAAMoJ,IAExG,CACA,OAAAC,CAAQ3H,EAAakH,GACnB,IAAIU,EACJ,OAAO5H,EAAY2H,QAAQT,GAAsC,OAA7BU,EAAc3J,KAAK2I,YAAiB,EAASgB,EAAYd,gBAAkB,GACjH,CACA,cAAAe,CAAe7H,EAAakH,GAC1B,MAAMtI,EAAUoB,EAAY8H,WAAWZ,EAAOjJ,KAAK2I,OAC7C3G,EAAcD,EAAYC,YAAYiH,GACtCa,EAAwB9J,KAAKyI,mBACjC,QACEtH,GACE2I,EACJ3J,EAAQ2H,GAAyBgC,EAAuB,IAC1D,OAAOlJ,EAAEwH,GAAsBvL,OAAOyL,OAAO,CAC3CvG,YAAaA,EACbZ,QAAS,IAAMA,EAAQa,IACtB7B,GAAQQ,EACb,CACA,gBAAAoJ,GACE,MAAMC,EAAc,GACpB,IAAK,MAAMjI,KAAe/B,KAAKgJ,aAAc,CAC3C,IAAKjH,EAAYkI,UAAW,SAC5B,IAAIP,EAAU9G,MAAMsH,KAAKlK,KAAKmJ,QAAQpH,EAAYpC,QAAQwK,UAAUvL,OAAOqK,GAASjJ,KAAK0J,QAAQ3H,EAAakH,IAC9G,MAAMmB,EAAMrI,EAAYsI,yBACpBD,IAAKV,EAAUA,EAAQY,OAAO,EAAGF,IACrC,IAAK,MAAMnB,KAASS,EAAS,CAC3B,MAAMa,EAAevK,KAAK4J,eAAe7H,EAAakH,GACtDe,EAAYlL,KAAKyL,EACnB,CACF,CACA,OAAOP,CACT,EAEFvM,OAAOC,IAAIkC,IAAI,kBAAmB,uCAAwC4I,IC1E3D,MAAMgC,GACnB,WAAA3M,GACEC,EAAgBkC,KAAM,iBAAa,GACnClC,EAAgBkC,KAAM,oBAAgB,GACtClC,EAAgBkC,KAAM,kBAAc,EACtC,CACA,gBAAAyK,GACE,IAAIC,EACJ,OAA6C,OAArCA,EAAkB1K,KAAK2K,WAAqBD,EAAkB1K,KAAK2K,UAAY3K,KAAKgJ,aAAajI,IAAI6J,GAAe,IAAIA,EAAY5K,MAC9I,CACA,cAAA6K,CAAelL,GACb,IAAImL,EACJ,OAA6G,OAArGA,EAAwB9K,KAAKyK,mBAAmBhF,KAAK1D,GAAeA,EAAYpC,SAAWA,IAAiBmL,EAAwB,IAC9I,CACA,MAAAC,CAAOhJ,GACL,IAAK/B,KAAKgL,WAAY,MAAM,IAAIC,MAAM,iDACtCjL,KAAKgJ,aAAalK,KAAKiD,EACzB,EAUFtE,OAAOC,IAAIkC,IAAI,kBAAmB,2CAA4C4K,IC5B9E,MAAM,GAA+B/M,OAAOC,IAAIV,IAAI,OAAQ,4B,eCA5D,MAAM,GAA+BS,OAAOC,IAAIV,IAAI,OAAQ,4B,eCC7C,MAAMkO,GACnB,WAAArN,CAAYsN,GACVrN,EAAgBkC,KAAM,cAAU,GAChCA,KAAKmL,OAASA,CAChB,EAEF1N,OAAOC,IAAIkC,IAAI,kBAAmB,sCAAuCsL,ICPzE,MAAM,GAA+BzN,OAAOC,IAAIV,IAAI,OAAQ,4B,eCQrD,MACDoO,GAAqB,IAAM,KAAY,eAAe1K,MAAM,mCAUnD,SAAS2K,GAAoBC,EAAMC,GAIhD,YAHuB,IAAnBA,IACFA,GAAiB,GAEdD,IACSC,EAAiBD,EAAKE,cAAgBF,EAAKG,aAAeL,MAC5DrI,QAAQ,qBAAsB,KAFxBqI,KAAqBrI,QAAQ,qBAAsB,IAGvE,CACAtF,OAAOC,IAAIkC,IAAI,kBAAmB,kCAAmCyL,ICrBtD,MAAMK,WAAoBR,GACvC,IAAAvL,GACE,MAAO,MACT,CACA,cAAA6J,GACE,OAAO5G,MAAMsH,KAAK,UAAUyB,IAAI,SAClC,CAgBA,WAAA3J,CAAYsJ,GACV,GDrBoC,UAAUM,UAAU,8BCqB9B,CACxB,MAAMC,EAAYR,GAAoBC,GAAM,GAC5C,OAAOtL,KAAKmL,OAAOA,OAAOU,EAC5B,CACA,MAAMA,EAAYR,GAAoBC,GACtC,OAAOtL,KAAKmL,OAAOA,OAAOU,EAAW,GAAIP,EAAKjL,KAChD,CACA,UAAAwJ,CAAWZ,EAAON,GAChB,MAAM8C,EAAW,IAAexC,EAAO5F,GAAQ,KAAUA,EAAMsF,IAC/D,OAAO/H,EAAE,IAAK,KAAMA,EAAE,KAAQ,CAC5B0K,KAAMrC,IACJwC,EACN,CACA,OAAA/B,CAAQT,EAAON,GACb,QAAKA,GACS,CAACM,EAAMwC,WAAYxC,EAAMuC,eAC1BM,KAAKzI,GAAQA,EAAKwF,cAAckD,OAAO,EAAGpD,EAAMzJ,UAAYyJ,EAC3E,CACA,sBAAA0B,GACE,OAAO,IACT,CACA,YAAMnB,CAAOP,GACX,aAAa,UAAUlD,KAAK,QAAS,CACnC7G,OAAQ,CACNoN,EAAGrD,GAELnJ,KAAM,CACJC,MAAO,IAGb,CACA,OAAAwK,GACE,OAAO,CACT,EAEFxM,OAAOC,IAAIkC,IAAI,kBAAmB,iCAAkC8L,ICzDrD,MAAMO,WAAoBf,GACvC,IAAAvL,GACE,MAAO,MACT,CAQA,cAAA6J,GACE,IAAK,aAAaxG,YAAY,2CAA6C,aAAaA,YAAY,4CAClG,MAAO,GAIT,MAAMkJ,EAAgB,aAAahK,KAAK/B,MAClCgM,EAAeD,EAAc9L,KAEnC,OADmB+L,GAAgBA,EAAalJ,cAAgBiJ,EAAcjJ,YAC5DmJ,QAEjBxN,OAAOwB,GAAQA,GAA+B,YAAvBA,EAAKiM,iBAAiCF,GAAgB/L,EAAKc,SAAWiL,EAAajL,WAE1GZ,KAAK,CAAC9D,EAAG8P,IAAMA,EAAEC,YAAYC,UAAYhQ,EAAE+P,YAAYC,UAC1D,CAUA,WAAAxK,CAAY5B,GACV,MACMyL,EAAYR,GADLjL,EAAKkL,QAElB,OAAOtL,KAAKmL,OAAOA,OAAOU,EAAW,IAAKzL,EAAKC,KACjD,CACA,UAAAwJ,CAAWZ,EAAON,GAChB,IAAI8D,EACJ,MAAMnB,EAAOrC,EAAMqC,QAAU,KACvBG,EAAW,IAAeH,EAAMjI,GAAQ,KAAUA,EAAMsF,IAC9D,OAAO/H,EAAE,IAAK,KAAMA,EAAE,KAAQ,CAC5B0K,KAAMA,IACJG,EAAU,CAAC,eAAe/K,MAAM,oDAAqD,CACvFQ,OAAQ+H,EAAM/H,WACZ,OAAO,IAAAwL,UAAyD,OAA/CD,EAAsBxD,EAAM0D,gBAA0BF,EAAsB,GAAI,MACvG,CACA,OAAA/C,CAAQT,EAAON,GACb,MAAM2C,EAAOrC,EAAMqC,OACbsB,EAAkB,mBAAmB7K,YAAY,QACvD,OAAQ4G,GAAS2C,GAAQsB,EAAgBlD,QAAQ4B,EAAM3C,EACzD,CACA,sBAAA0B,GACE,OAAO,CACT,CAKA,MAAAnB,CAAOP,GACL,OAAO/G,QAAQC,QAAQ,GACzB,CACA,OAAAoI,GACE,OAAO,CACT,EAEFxM,OAAOC,IAAIkC,IAAI,kBAAmB,iCAAkCqM,IC5EpE,MAAM,GAA+BxO,OAAOC,IAAIV,IAAI,OAAQ,uB,eCA5D,MAAM,GAA+BS,OAAOC,IAAIV,IAAI,OAAQ,2B,eCK7C,MAAM6P,WAAqB3B,GACxC,IAAAvL,GACE,MAAO,OACT,CACA,cAAA6J,GACE,OAAO5G,MAAMsH,KAAK,UAAUyB,IAAI,UAAU/M,OAAOkO,GACxCA,EAAEzM,OAAS,eAAkByM,EAAEzM,OAAS,gBAEnD,CAWA,WAAA2B,CAAY+K,GACV,OAAO/M,KAAKmL,OAAOA,OAAO4B,EAAMC,aAAc,IAAKD,EAAM1M,KAC3D,CACA,UAAAwJ,CAAWZ,EAAON,GAChB,IAAIsE,EAAYhE,EAAM+D,aAItB,OAHIrE,IACFsE,EAAY,KAAUA,EAAWtE,IAE5B/H,EAAE,IAAK,KAAMA,EAAE,KAAO,CAC3BJ,UAAW,8BAA8BoF,OAAOqD,EAAM5I,KAAM,eAC5D6M,MAAOjE,EAAMiE,QACbvN,KAAM,QACNwN,KAAMlE,EAAMkE,SACVvM,EAAE,OAAQ,CACZJ,UAAW,YACVyM,GACL,CACA,OAAAvD,CAAQT,EAAON,GACb,QAAKA,GACS,CAACM,EAAM+D,aAAanE,cAAeI,EAAMmE,eAAevE,eACzDiD,KAAKzI,GAAQA,EAAKwF,cAAckD,OAAO,EAAGpD,EAAMzJ,UAAYyJ,EAC3E,CACA,sBAAA0B,GACE,OAAO,IACT,CAKA,MAAAnB,CAAOP,GACL,OAAO/G,QAAQC,QAAQ,GACzB,CACA,OAAAoI,GACE,IAAIoD,EAAuBC,EAC3B,OAAkK,OAA1JD,EAAwD,OAA/BC,EAAe,cAA8D,OAArCA,EAAeA,EAAahC,WAAgB,EAASgC,EAAaC,qBAA8BF,CAC3K,EAEF5P,OAAOC,IAAIkC,IAAI,kBAAmB,kCAAmCiN,ICxDtD,MAAMW,WAAwBhD,GAC3C,WAAA3M,GACE6B,SAAST,WACTnB,EAAgBkC,KAAM,eAAgB,CAAC0L,GAAaO,GAAaY,KACjE/O,EAAgBkC,KAAM,cAAc,EACtC,CACA,OAAAyN,GACE,MAAO,GACT,CACA,cAAAC,CAAe/E,GACb,MAAMgF,EAAahF,EAAMjG,MAAM,yBAC/B,OAAOiL,EAAaA,EAAW,GAAK,IACtC,CACA,MAAAxC,CAAO9H,EAAMuK,EAAMvN,GAOjB,YANa,IAATuN,IACFA,EAAO,SAEE,IAAPvN,IACFA,EAAK,MAEA,CACLwN,OAAQ,IAAIjI,OAAOvC,GACnByK,KAAM,KAAMlI,OAAOvC,EAAM,MAAOuC,OAAOgI,GAAMhI,OAAOvF,IACpDA,EAAK,OAAS,SAClB,EAEF5C,OAAOC,IAAIkC,IAAI,kBAAmB,6CAA8C4N,IC3BjE,MAAMO,WAAmB7C,GACtC,IAAAvL,GACE,MAAO,KACT,CACA,cAAA6J,GACE,OAAO5G,MAAMsH,KAAK,UAAUyB,IAAI,QAClC,CAWA,WAAA3J,CAAYgM,GACV,OAAOhO,KAAKmL,OAAOA,OAAO6C,EAAIC,OAChC,CACA,OAAAvE,CAAQT,EAAON,GACb,QAAKA,GACS,CAACM,EAAM5F,OAAOwF,eACfiD,KAAKzI,GAAQA,EAAKwF,cAAckD,OAAO,EAAGpD,EAAMzJ,UAAYyJ,EAC3E,CACA,sBAAA0B,GACE,OAAO,IACT,CACA,YAAMnB,CAAOP,GACX,aAAa,UAAUlD,KAAK,OAAQ,CAClC7G,OAAQ,CACNoN,EAAGrD,GAELnJ,KAAM,CACJC,MAAO,IAGb,CACA,UAAAoK,CAAWZ,EAAON,GAChB,IAAIuF,EAAUjF,EAAM5F,OAIpB,OAHIsF,IACFuF,EAAU,KAAUA,EAASvF,IAExB/H,EAAE,IAAK,KAAMA,EAAE,KAAO,CAC3BJ,UAAW,SACX2M,KAAMlE,EAAMkE,OACZD,MAAOjE,EAAMiE,QACbvN,KAAM,QACJiB,EAAE,OAAQ,CACZJ,UAAW,YACV0N,GACL,CACA,OAAAjE,GACE,MAAO,gBAAiBxM,OAAO0Q,UACjC,EAEF1Q,OAAOC,IAAIkC,IAAI,kBAAmB,gCAAiCmO,ICzDpD,MAAMK,WAA0B5D,GAC7C,WAAA3M,GACE6B,SAAST,WACTnB,EAAgBkC,KAAM,eAAgB,CAAC+N,KACvCjQ,EAAgBkC,KAAM,cAAc,EACtC,CACA,OAAAyN,GACE,MAAO,GACT,CACA,cAAAC,CAAe/E,GACb,MAAMgF,EAAahF,EAAMjG,MAAM,qqUAC/B,OAAOiL,EAAaA,EAAW,GAAK,IACtC,CACA,MAAAxC,CAAO8C,GACL,MAAO,IAAIrI,OAAOqI,EACpB,EAEFxQ,OAAOC,IAAIkC,IAAI,kBAAmB,+CAAgDwO,ICjBnE,MAAMC,GACnB,WAAAxQ,GACEC,EAAgBkC,KAAM,UAAW,CAAC,IAAIwN,GAAmB,IAAIY,IAC/D,CACA,GAAApR,CAAIsR,GACF,IAAIC,EACJ,OAAgF,OAAxEA,EAAqBvO,KAAKwO,QAAQ/I,KAAKgJ,GAAKA,EAAEhB,YAAca,IAAmBC,EAAqB,IAC9G,CACA,WAAAxM,CAAYpC,GACV,IAAK,MAAMwL,KAAUnL,KAAKwO,QAAS,CACjC,MAAMzM,EAAcoJ,EAAON,eAAelL,GAC1C,GAAIoC,EAAa,OAAOA,CAC1B,CACA,OAAO,IACT,CACA,MAAAgJ,CAAOI,GACLnL,KAAKwO,QAAQ1P,KAAK,IAAIqM,EACxB,EAEF1N,OAAOC,IAAIkC,IAAI,kBAAmB,4CAA6CyO,ICtB/E,MAAM,GAA+B5Q,OAAOC,IAAIV,IAAI,OAAQ,6B,eCA5D,MAAM,GAA+BS,OAAOC,IAAIV,IAAI,OAAQ,gC,eCA5D,MAAM,GAA+BS,OAAOC,IAAIV,IAAI,OAAQ,oB,eCA5D,MAAM,GAA+BS,OAAOC,IAAIV,IAAI,OAAQ,sB,eCA5D,MAAM,GAA+BS,OAAOC,IAAIV,IAAI,OAAQ,sB,eCA5D,MAAM,GAA+BS,OAAOC,IAAIV,IAAI,OAAQ,kC,eCI7C,MAAM0R,WAAyB,MAC5C,MAAAnP,CAAO+L,GACL,MAAO,CACL1M,OAAQ,CACNe,KAAM,UACNgP,UAAWrD,EAAKjL,MAGtB,EAEF5C,OAAOC,IAAIkC,IAAI,kBAAmB,oCAAqC8O,ICdvE,MAAM,GAA+BjR,OAAOC,IAAIV,IAAI,OAAQ,iC,eCG7C,MAAM4R,WAAkC,MACrD,IAAAzB,GACE,MAAO,cACT,CACA,IAAApH,GACE,MAAM8I,EAAe7O,KAAKG,MAAM0O,aAC1BzO,EAAOyO,EAAaC,UACpBnO,EAAUkO,EAAalO,UAC7B,OAAO,UAAUsC,WAAW7C,EAAK6C,aAActC,GAAWA,EAAQoO,YACpE,CACA,OAAApO,GACE,MACM2K,EADetL,KAAKG,MAAM0O,aACNG,WAC1B,OAAO,eAAetO,MAAM,0DAA2D,CACrF4K,OACA2D,MAAO,GAEX,CACA,OAAAC,GACE,OAAO,IAAAxC,UAAS1M,KAAKG,MAAM0O,aAAaC,UAAUnC,gBAAkB,GAAI,IAC1E,EAEFlP,OAAOC,IAAIkC,IAAI,kBAAmB,6CAA8CgP,ICtBjE,MAAMO,WAAkC,MACrD,IAAAhC,GACE,MAAO,WACT,CACA,IAAApH,GACE,MAAM3F,EAAOJ,KAAKG,MAAM0O,aAAaC,UACrC,OAAO,UAAU7L,WAAW7C,EAAK6C,aAAc7C,EAAKc,SACtD,CACA,OAAAP,GACE,MAAM2K,EAAOtL,KAAKG,MAAM0O,aAAaG,WACrC,OAAO,eAAetO,MAAM,0DAA2D,CACrF4K,QAEJ,CACA,OAAA4D,GACE,OAAO,IAAAxC,UAAS1M,KAAKG,MAAM0O,aAAaC,UAAUnC,eAAgB,IACpE,EAEFlP,OAAOC,IAAIkC,IAAI,kBAAmB,6CAA8CuP,IClBjE,MAAMC,WAAmC,MACtD,IAAAjC,GACE,MAAO,WACT,CACA,IAAApH,GACE,MAAM3F,EAAOJ,KAAKG,MAAM0O,aAAaC,UACrC,OAAO,UAAU7L,WAAW7C,EAAK6C,aAAc7C,EAAKc,SACtD,CACA,OAAAP,GACE,MAAM2K,EAAOtL,KAAKG,MAAM0O,aAAaG,WACrC,OAAO,eAAetO,MAAM,2DAA4D,CACtF4K,QAEJ,CACA,OAAA4D,GACE,OAAO,IAAAxC,UAAS1M,KAAKG,MAAM0O,aAAaC,UAAUnC,eAAgB,IACpE,EAEFlP,OAAOC,IAAIkC,IAAI,kBAAmB,8CAA+CwP,ICrBjF,MAAM,GAA+B3R,OAAOC,IAAIV,IAAI,OAAQ,wBCAtD,GAA+BS,OAAOC,IAAIV,IAAI,OAAQ,c,eCE7C,MAAMqS,WAAwB,GAAAC,eAC3C,GAAA3S,GACE,OAAO,gBAAe+D,MAAM,kDAAmD,CAAC,GAAG,EACrF,CACA,IAAA6O,GACE,OAAO,gBAAe7O,MAAM,mDAAoD,CAAC,GAAG,EACtF,CACA,SAAA8O,GACE,MAAO,WACT,EAEF/R,OAAOC,IAAIkC,IAAI,kBAAmB,qCAAsCyP,ICXxE,MCMA,KDNgB,IAAI,cACnBI,OAAO,QAASJ,KCKgB,IAAI,cACpCzP,IAAI,gBAAiB,wBAAyB8O,IAAmB,IAAI,YAAa,MAClFgB,QAAQ,eAAe9D,UAAU,qBAAqB,IAAI,oBAC1DhM,IAAI,gBAAiBgP,IAA2BhP,IAAI,gBAAiBuP,IAA2BvP,IAAI,iBAAkBwP,IAA6B,IAAI,YAAa,MACpKxD,UAAU,qBCTJ,SAAS+D,GAAmB3B,GACjC,IAAI1C,EAEJ,GADI,UAAUM,UAAU,+BAAiCoC,EAAI4B,aAAa,YAAatE,EAAO,UAAUuE,MAAM,QAAS,WAAY7B,EAAI8B,aAAa,aAAsB9B,EAAI4B,aAAa,QAAOtE,EAAO,UAAUyE,QAAQ,QAAS/B,EAAI8B,aAAa,QACjPxE,EAIF,OAHA0C,EAAIgC,aAAa,KAAM1E,EAAKjL,MAC5B2N,EAAIgC,aAAa,OAAQ1E,EAAK2C,QAC9BD,EAAIgC,aAAa,cAAe,KAAY,IAAS1E,MAC9C,EAET0C,EAAIiC,YACN,CACO,SAASC,GAAuBlC,GACrCA,EAAIgC,aAAa,WAAW,EAC9B,CACO,SAASG,GAAmBnC,GACjC,MAAM5N,EAAO,UAAU2P,QAAQ,QAAS/B,EAAI8B,aAAa,OACzD,GAAI1P,EAIF,OAHA4N,EAAIgC,aAAa,eAAgB5P,EAAK6C,aAAa5C,MACnD2N,EAAIgC,aAAa,SAAU5P,EAAKc,UAChC8M,EAAIgC,aAAa,cAAe,KAAY,IAAS5P,EAAKkL,WACnD,CAEX,CACO,SAAS8E,GAAuBpC,GACrCA,EAAIgC,aAAa,WAAW,EAC9B,CACO,SAASK,GAAoBrC,GAClC,IAAIV,EACJ,GAAoC,OAA/BA,EAAe,cAA8D,OAArCA,EAAeA,EAAahC,OAAiBgC,EAAaC,mBAAoB,CACzH,MAAMR,EAAQ,UAAUgD,QAAQ,SAAU/B,EAAI8B,aAAa,OAC3D,GAAI/C,EAEF,OADAiB,EAAIgC,aAAa,YAAa,KAAYjD,EAAMC,gBACzC,CAEX,CACAgB,EAAIiC,YACN,CACO,SAASK,GAAwBtC,GACtC,IAAIuC,EACJ,GAAqC,OAAhCA,EAAgB,cAAgE,OAAvCA,EAAgBA,EAAcjF,OAAiBiF,EAAchD,mBAAoB,CAC7H,MAAMR,EAAQ,UAAUgD,QAAQ,SAAU/B,EAAI8B,aAAa,OAC3D9B,EAAIgC,aAAa,QAASjD,EAAMG,SAChCc,EAAIgC,aAAa,OAAQjD,EAAMI,QAC/Ba,EAAIgC,aAAa,WAAW,EAC9B,CACF,CACO,SAASQ,GAAkBxC,GAChC,GAAI,gBAAiBvQ,OAAO0Q,WAAY,CACtC,MAAMlF,EAAQ,UAAU4G,MAAM,OAAQ,OAAQ7B,EAAI8B,aAAa,SAC/D,GAAI7G,EAGF,OAFA+E,EAAIgC,aAAa,KAAM/G,EAAM5I,MAC7B2N,EAAIgC,aAAa,UAAW/G,EAAM5F,SAC3B,CAEX,CACA2K,EAAIiC,YACN,CACO,SAASQ,GAAsBzC,GACpC,GAAI,gBAAiBvQ,OAAO0Q,WAAY,CACtC,MAAMlF,EAAQ,UAAU4G,MAAM,OAAQ,OAAQ7B,EAAI8B,aAAa,SAC/D9B,EAAIgC,aAAa,OAAQ/G,EAAMkE,QAC/Ba,EAAIgC,aAAa,QAAS/G,EAAMiE,SAChCc,EAAIgC,aAAa,WAAW,EAC9B,CACF,CACAvS,OAAOC,IAAIkC,IAAI,kBAAmB,4BAA6B,CAAE+P,mBAAoBA,GAAmBO,uBAAwBA,GAAuBC,mBAAoBA,GAAmBC,uBAAwBA,GAAuBC,oBAAqBA,GAAoBC,wBAAyBA,GAAwBE,kBAAmBA,GAAkBC,sBAAuBA,KCxBnYhT,OAAOC,IAAIkC,IAAI,kBAAmB,+BA3CnB,MACb,WAAA/B,GACEC,EAAgBkC,KAAM,UAAW,IACjClC,EAAgBkC,KAAM,eAAgB,CAAC,EACzC,CAKA,MAAAmL,CAAOA,GAEL,OADAnL,KAAKwO,QAAQ1P,KAAKqM,GACXnL,IACT,CAWA,WAAA+B,CAAYuM,EAAQvM,GAKlB,OAJK/B,KAAKgJ,aAAasF,KACrBtO,KAAKgJ,aAAasF,GAAU,IAE9BtO,KAAKgJ,aAAasF,GAAQxP,KAAKiD,GACxB/B,IACT,CACA,MAAA+K,CAAO2F,GACL,IAAK,MAAMvF,KAAUnL,KAAKwO,QACxBkC,EAAIC,eAAe5F,OAAOI,GAE5B,IAAK,MAAMmD,KAAUtO,KAAKgJ,aAAc,CACtC,MAAMmC,EAASuF,EAAIC,eAAe3T,IAAIsR,GACtC,GAAKnD,EACL,IAAK,MAAMpJ,KAAe/B,KAAKgJ,aAAasF,GAC1CnD,EAAOJ,OAAOhJ,EAElB,CACF,IC7BF,mBAAqB,IAAIsM,GAEzB,iBAAiBzO,IAAI,kBAAmB,MCXzB,WACb,SAASgR,IACP,MAAMC,EAAc7Q,KAAKG,MAAMC,KAAKyQ,cACpC,GAAIA,IAAgB7Q,KAAK8Q,oBAAsB9Q,KAAK+Q,YAAa,OACjE/Q,KAAK8Q,mBAAqBD,EAC1B,MAAMG,EAAahR,KAAKG,MAAMC,KACxB6Q,EAAcjR,KAAK0D,IACzB1D,KAAK0D,IAAIS,GAAG,QAAS,0HAA2H,SAAUpG,GACxJ6C,EAAEsQ,MAAM7H,IAAIrJ,KAAK8P,aAAa,SAC9B/R,EAAEoT,gBACJ,GACAnR,KAAK0D,EAAE,2CAA2C0N,KAAK,WACrD,MAAM3N,EAAQC,EAAE1D,MACVK,EAAKoD,EAAM4N,KAAK,MACtB,IAAIC,EAIJ,MAAMC,EAAW7N,EAAE,wDACnBuN,EAAY1L,OAAOgM,GACnB,MAAMC,EAAiB,IACd9N,EAAE,6BAA8BkC,OAAOvF,EAAI,OAE9CoR,EAAc,KAIlB,MAAMC,EAAQF,IACd,IAAIG,GAAU,EACd,GAAID,EAAMxS,OAAQ,CAChB,MAAMsE,EAAMkO,EAAM7N,SAASL,IACrBc,EAAYD,OAAOuN,YACrBpO,EAAMc,GAAad,EAAMkO,EAAMG,SAAWvN,EAAYZ,EAAEW,QAAQwN,WAClEH,EAAMrK,SAAS,WACfsK,GAAU,EAEd,CAIA,IAAKA,EAAS,CAGZ,MAAMG,EAAkB,KACtB,MAAMC,EAAgBR,EAAShN,aAAY,GAC3C,IAAIV,EAAS,EAITJ,EAAMI,SAASL,IAAMuO,EAAgBrO,EAAEW,QAAQC,YAAcZ,EAAE,WAAWa,cAC5EV,GAAUJ,EAAMc,aAAY,GAE5BV,GAAUkO,EAEZR,EAASjO,OAAOQ,IAAI,MAAOL,EAAMI,SAASL,IAAMyN,EAAYpN,SAASL,IAAMK,GAAQC,IAAI,OAAQL,EAAMG,eAAeC,SAASN,KAAO0N,EAAYpN,SAASN,MAAMO,IAAI,YAAaL,EAAMG,eAAeoO,UAEjMC,EAAW7R,IACf,MAAM6C,EAAa7C,EAAK6C,aACxBrC,EAAEsR,OAAOX,EAAS,GAAI,CAACtO,IAAe+N,EAAW/N,cAAgBrC,EAAE,KAAM,KAAMA,EAAE,OAAQ,CACvFJ,UAAW,kCACVyC,EAAWxC,UAAWG,EAAE,KAAM,KAAMA,EAAE,IAAa,CACpDR,KAAMA,OAER0R,KAEI1R,EAAOsQ,IAAIyB,MAAMpC,QAAQ,QAAS1P,GACpCD,GAAQA,EAAK6C,aACfgP,EAAS7R,IAETQ,EAAEsR,OAAOX,EAAS,GAAI3Q,EAAE,IAAkB,OAC1C8P,IAAIyB,MAAM1M,KAAK,QAASpF,GAAI6C,KAAK+O,GACjCH,KAEFnL,WAAW,IAAM4K,EAAS3M,IAAI,iBAAiByC,SAAS,MAC1D,GAEI+K,EAAc,KAClBZ,IAAiBpK,YAAY,WACzBmK,EAASc,SAAS,OACpBd,EAASnK,YAAY,MAAMkL,IAAI,gBAAiB,IAAMf,EAASvN,SAOnEP,EAAMU,GAAG,WAAYpG,IACfA,EAAEwU,YACJxU,EAAEoT,mBAGN1N,EAAM7D,IAAI2R,GAAUiB,MAAM,KACxB/L,aAAa6K,GACbA,EAAU3K,WAAW8K,EAAa,MACjC,KACDhL,aAAa6K,GACbE,IAAiBpK,YAAY,WAC7BkK,EAAU3K,WAAWyL,EAAa,OACjCjO,GAAG,WAAYpG,IAChB0T,IACA1T,EAAE0U,oBAEJ/O,EAAEQ,UAAUC,GAAG,WAAYiO,EAC7B,EACF,EACA,IAAArH,QAAO,cAAuB,WAAY6F,IAC1C,IAAA7F,QAAO,cAAuB,WAAY6F,EAC5C,CD7FE8B,GERa,WACb,SAASN,IACPpS,KAAK0D,EAAE,6BAA6B0D,YAAY,MAAMkL,IAAI,gBAAiB,WACzE5O,EAAE1D,MAAMgE,MACV,EACF,EACA,IAAA+G,QAAO,cAAuB,WAAY,WACxC,IAAIuG,EACJ,MAAMlR,EAAOJ,KAAKG,MAAMC,KAClBuS,EAAUvS,EAAKwS,cACrB,GAAID,GAAWA,EAAQzT,OAAQ,CAC7B,MAAMqS,EAAW7N,EAAE,6DACnB1D,KAAK0D,IAAI6B,OAAOgM,GAChB,MAAMN,EAAcjR,KAAK0D,IACnBD,EAAQzD,KAAK0D,EAAE,qBACf+N,EAAc,MACbF,EAASc,SAAS,OAASd,EAASsB,GAAG,cAK5CjS,EAAEsR,OAAOX,EAAS,GAAI3Q,EAAE,IAAK,KAAM+R,EAAQ5R,IAAIE,GAASL,EAAE,KAAM,CAC9D,cAAeK,EAAMC,UACpBN,EAAE,IAAa,CAChBR,KAAMa,EACNE,QAASiR,EAAYnO,KAAKjE,UACtB2S,EAAQzT,OAASkB,EAAK0S,oBAAsBlS,EAAE,KAAM,CACxDJ,UAAW,iCACVI,EAAE,IAAQ,CACXJ,UAAW,qBACXW,QAAS,KACPiR,EAAY/U,KAAK2C,MACjB,UAAUsD,KAAKzD,EAAkB,CAC/BO,WAGHQ,EAAE,OAAQ,CACXJ,UAAW,uBACVI,EAAE,OAAQ,CACXJ,UAAW,4BACVI,EAAE,IAAM,CACTyC,KAAM,sBACHzC,EAAE,OAAQ,KAAM,eAAeF,MAAM,oDAAqD,CAC7FuO,MAAO7O,EAAK0S,mBAAqBH,EAAQzT,eAE3CqS,EAASjO,OAAOQ,IAAI,MAAOL,EAAMI,SAASL,IAAMyN,EAAYpN,SAASL,IAAMC,EAAMc,aAAY,IAAOT,IAAI,OAAQL,EAAMG,eAAeC,SAASN,KAAO0N,EAAYpN,SAASN,MAAMO,IAAI,YAAamN,EAAYe,SAC7MrL,WAAW,IAAM4K,EAAS3M,IAAI,iBAAiByC,SAAS,SAE1D5D,EAAM7D,IAAI2R,GAAUiB,MAAM,KACxB/L,aAAa6K,GACbA,EAAU3K,WAAW8K,EAAa,MACjC,KACDhL,aAAa6K,GACbA,EAAU3K,WAAWyL,EAAa,OAMpCpS,KAAK0D,IAAI+B,KAAK,+BAA+B+M,MAAM,WACjDjB,EAAS9L,KAAK,iBAAmB/B,EAAE1D,MAAMqR,KAAK,UAAY,MAAMhK,SAAS,SAC3E,EAAG,WACDkK,EAAS9L,KAAK,iBAAiB2B,YAAY,SAC7C,EACF,CACF,IACA,IAAA2D,QAAO,cAAuB,cAAe,SAAU/J,GACrD,MAAMZ,EAAOJ,KAAKG,MAAMC,KAClBuS,EAAUvS,EAAKwS,cACrB,GAAID,GAAWA,EAAQzT,OAAQ,CAC7B,MAAM6T,EAAQ,GACRC,EAAWL,EAAQrS,KAAKW,GAASA,EAAMqK,SAAW,YAAYA,MAAQ,EAAI,GAAG1M,OAAOqC,IACxF,MAAMqK,EAAOrK,EAAMqK,OACnB,IAA6B,IAAzByH,EAAM/K,QAAQsD,GAEhB,OADAyH,EAAMjU,KAAKwM,IACJ,IAGL7L,EAAQ,EACRwT,EAAY7S,EAAK0S,mBAAqBrT,EAItCyT,EAAQF,EAASxQ,MAAM,EAAGyQ,EAAYxT,EAAQ,EAAIA,GAAOsB,IAAIE,IACjE,MAAMqK,EAAOrK,EAAMqK,OACnB,OAAO1K,EAAE,IAAM,CACbmF,KAAM,UAAU3F,KAAKa,GACrBE,QAASiR,EAAYnO,KAAKjE,MAC1B,cAAeiB,EAAMC,UACpB,YAAYoK,OAASA,EAAO,eAAe5K,MAAM,uCAAyC,IAAS4K,MAMxG,GAAI2H,EAAW,CACb,MAAMhE,EAAQ7O,EAAK0S,mBAAqBI,EAAMhU,OAC9CgU,EAAMpU,KAAK,eAAe4B,MAAM,yCAA0C,CACxEuO,UAEJ,CACAjO,EAAMpB,IAAI,UAAWgB,EAAE,MAAO,CAC5BJ,UAAW,oBACVI,EAAE,OAAQ,CACXJ,UAAW,4BACVI,EAAE,IAAM,CACTyC,KAAM,iBACJ,eAAe3C,MAAM,0CAA0CkF,OAAOoN,EAAS,GAAG1H,SAAW,YAAYA,KAAO,QAAU,GAAI,SAAU,CAC1I2D,MAAOiE,EAAMhU,OACb6T,MAAO,IAAgBG,OAE3B,CACF,EACF,CFrGEC,IGhBA,IAAApI,QAAO,cAAuB,cAAe,SAAU/J,GACrD,MAAMZ,EAAOJ,KAAKG,MAAMC,KACpBA,EAAKgT,YAAc,YAAY9H,OAASlL,EAAK6C,aAAaoQ,YAC9DrS,EAAMpB,IAAI,QAASgB,EAAE,IAAQ,CAC3BJ,UAAW,sBACXW,QAAS,IAAMF,EAAMb,IACpB,eAAeM,MAAM,0CAC1B,ICPA,IAAAqK,QAAO,cAAuB,WAAY,WACxC,MAAM3K,EAAOJ,KAAKG,MAAMC,KACxB,GAAIA,EAAKgT,YAAc,YAAY9H,OAASlL,EAAK6C,aAAaoQ,WAAY,OAC1E,MAAMC,EAAYtT,KAAK0D,EAAE,cAInB6P,EAAa7P,EAAE,iDACf8P,EAAS,IAAIrQ,EAAgB/C,GAC7BqT,EAAU,SAAU1V,GACxB4I,WAAW,KACT,MAAMhG,EAAUkE,EAAayO,GAC7B,GAAI3S,EAAS,CACX6S,EAAO7S,QAAUA,EACjBC,EAAEsR,OAAOqB,EAAW,GAAIC,EAAOtB,UAC/B,MAAMwB,EAAQrP,OAAOU,eAAeG,WAAW,GAAGyO,iBAC5CC,EAAYF,EAAM,GACxB,GAAI3V,EAAE8V,QAAUD,EAAUlP,QAAU3G,EAAE+V,QAAUF,EAAUnP,MAAQmP,EAAUrQ,KAAOxF,EAAE+V,QACnFN,EAAOpP,UAAUwP,EAAUrQ,KAAMqQ,EAAUpQ,SACtC,CACL,MAAMuQ,EAAWL,EAAMA,EAAMxU,OAAS,GACtCsU,EAAOhP,QAAQuP,EAAStP,MAAOsP,EAASrP,OAC1C,CACF,GACC,EACL,EACA1E,KAAK0D,IAAIsQ,MAAMT,GAAYpP,GAAG,UAAWsP,GACrC,iBAAkBpP,QACpBH,SAAS+P,iBAAiB,kBAAmBR,GAAS,EAE1D,IC3BA,IAAA1I,QAAO,sCAAuC,UAAW,WACvD/K,KAAKkU,iBAAmB,IAAIjO,GAC5BjG,KAAKmU,gBAAiB,KAAAC,UAAS,IAAK,CAACpL,EAAce,IAAqBf,EAAaE,SAAShG,KAAK6G,IACnG,MAAMsK,EAAUrU,KAAK0D,EAAE,sBAAsB4Q,KAAK,oDAClDtU,KAAKuU,UAAY,IAAI,KACrBvU,KAAKuU,UAAUC,KAAK,IAAMxU,KAAKkU,iBAAiB/N,QAAQsO,KAAK,IAAMzU,KAAKkU,iBAAiB9N,UAAU,IAAIsO,OAAO,IAAM1U,KAAKkU,iBAAiB9N,SAAS,IAAIuO,SAAS3U,KAAKkU,iBAAiBtN,SAAS3C,KAAKjE,KAAKkU,mBAAmBU,SAAS5U,KAAKkU,iBAAiBlQ,KAAKC,KAAKjE,KAAKkU,mBAAmBW,OAAOR,GACpSA,EAAQL,MAAMtQ,EAAE,8DAClB,IACA,IAAAqH,QAAO,sCAAuC,oBAAqB,SAAUxL,GAC3E,IAAIoO,EAgEJpO,EAAOuV,eAAehW,KA/DW,KAC/B,MAAMgG,EAAY9E,KAAKG,MAAMuB,SAASW,OAAOC,oBACvCyS,EAASjQ,EAAU,GACzB,GAAIA,EAAU,GAAKiQ,EAAS,EAAG,OAC/B,IAAIC,EAAe,KACnB,MACMC,EADqB,IAAI,IAAJ,CAAuBC,MAAgBF,EAAe,mBAAmBhY,IAAIkY,KAC9DC,MAAMnV,KAAKG,MAAMuB,SAASW,OAAO+S,cAAc,IAAKL,EAAQ,OAChGb,EAAmBlU,KAAKkU,iBAC9B,IAAIlL,EAAe,IAAIR,GAAkB,CACvC6M,aAAc,WACZnB,EAAiB3N,SAAS7C,EAAE1D,MAAMmF,SAASqB,QAC7C,EACArF,QAASa,IACPhC,KAAKG,MAAMuB,SAASW,OAAOiT,oBAAoBL,EAAeM,cAAgB,EAAGvT,EAAc,KAC/FhC,KAAKkU,iBAAiBlQ,UAK1B,GAFAhE,KAAKkU,iBAAiBlQ,OACtBhE,KAAKkU,iBAAiB/N,QAAS,EAC3B8O,EAAgB,CAGlB,GAFAjM,EAAaM,KAAK0L,EAAavK,oBAC/BkD,EAAaqH,EAAatH,eAAeuH,EAAetM,QACnDgF,EAAY,OACjB3E,EAAaL,MAAQgF,EACrB,MAAM5D,EAAmB,KAGvB,MAAMC,EAAchB,EAAae,mBACjC,GAAIC,EAAY9K,OAAQ,CACtBc,KAAKkU,iBAAiBlT,MAAQgJ,EAC9BpJ,EAAEsR,OAAOlS,KAAK0D,EAAE,2CAA2C,GAAI1D,KAAKkU,iBAAiBhC,UACrFlS,KAAKkU,iBAAiB5Q,OACtB,MAAMkS,EAAcxV,KAAKG,MAAMuB,SAASW,OAAOoT,oBAAoBR,EAAeM,eAC5EvD,EAAQhS,KAAKkU,iBAAiBxQ,IAAIiB,aAClCkN,EAAS7R,KAAKkU,iBAAiBxQ,IAAIa,cACnCY,EAASnF,KAAKkU,iBAAiBxQ,IAAIE,eACzC,IAAIL,EAAOiS,EAAYjS,KACnBC,EAAMgS,EAAYhS,IAAM,GAGxBA,EAAMqO,EAAS1M,EAAO0M,WACxBrO,EAAMgS,EAAYhS,IAAMqO,EAAS,IAE/BtO,EAAOyO,EAAQ7M,EAAO6M,UACxBzO,EAAO4B,EAAO6M,QAAUA,GAI1BxO,EAAMkS,KAAKtL,MAAMjF,EAAOtB,SAASL,IAAME,EAAEQ,UAAUI,aAAcd,GACjED,EAAOmS,KAAKtL,KAAKjF,EAAOtB,SAASN,KAAMA,GACvCvD,KAAKkU,iBAAiB5Q,KAAKC,EAAMC,EACnC,MACExD,KAAKkU,iBAAiB/N,QAAS,EAC/BnG,KAAKkU,iBAAiBlQ,QAG1BhE,KAAKkU,iBAAiB/N,QAAS,EAC/B4D,IACA/J,KAAKkU,iBAAiB3N,SAAS,GAC/BvG,KAAKkU,iBAAiBxQ,IAAIY,UAAU,GACpCtE,KAAKmU,eAAenL,EAAce,EACpC,GAGJ,IACA,IAAAgB,QAAO,sCAAuC,eAAgB,SAAU/J,GACtEA,EAAMpB,IAAI,UAAWgB,EAAE,IAAkB,CACvCO,QAAS,IAAMnB,KAAKG,MAAMuB,SAASW,OAAOM,eAAe,MACzDwK,KAAM,aACL,eAAezM,MAAM,mDAC1B,ILrDA,IAAAqK,QAAO,2CAA4C,oBAAqB,SAAU/J,GAChFA,EAAMpB,IAAI,gBAAiB,CACzByD,KAAM,gBACN8J,KAAM,eACNwI,MAAO,eAAejV,MAAM,gEAE9BM,EAAMpB,IAAI,gBAAiB,CACzByD,KAAM,gBACN8J,KAAM,YACNwI,MAAO,eAAejV,MAAM,gEAE9BM,EAAMpB,IAAI,iBAAkB,CAC1ByD,KAAM,iBACN8J,KAAM,YACNwI,MAAO,eAAejV,MAAM,gEAEhC,IAGA,IAAAqK,QAAO,eAAoB,WAAY,SAAU/J,GAC/C,MAAMsK,EAAOtL,KAAKsL,KAClBtK,EAAMpB,IAAI,WAAYgB,EAAE,KAAY,CAClCmF,KAAM,UAAU,gBAAiB,CAC/B0F,SAAUH,EAAK2C,SAEjB5K,KAAM,WACN8J,KAAM,aACL,eAAezM,MAAM,6CAA8C,GACxE,GAGA,EAAAkV,gBAAgBC,gBAAgB/W,KAAK,kBAGrC,IAAAiM,QAAO,cAAgB,WAAY,WACjC/K,KAAK0D,EAAE,gDAAgD0N,KAAK,WAC1DpR,KAAK8V,UAAUlW,IAAI,IAAkBmW,iBAAiB/V,MAAMgW,iBAAiB,YAC/E,EACF,IAGA,IAAAC,UAAS,sCAAuC,sBAAuB,SAAUC,GAC/E,MAAMC,EAAOD,IACb,OAAKC,GAAQ,YAAY9E,KAAK+E,WAAa,YAAY/E,KAAK+E,UAAUrN,SAAS,kBAAoB,YAAYsI,KAAK/F,KAC3G,QAEF6K,CACT,IACA,IAAApL,QAAO,sCAAuC,iBAAkB,SAAUsL,GACpE,YAAYhF,KAAK+E,WAAa,YAAY/E,KAAK+E,UAAUrN,SAAS,kBAAoB,YAAYsI,KAAK/F,OACzG+K,EAAQjK,MAAMuC,UAAY,YAAY0C,KAAK/F,KAAKG,WAEpD,I","sources":["webpack://@flarum/mentions/webpack/bootstrap","webpack://@flarum/mentions/webpack/runtime/compat get default export","webpack://@flarum/mentions/webpack/runtime/define property getters","webpack://@flarum/mentions/webpack/runtime/hasOwnProperty shorthand","webpack://@flarum/mentions/webpack/runtime/make namespace object","webpack://@flarum/mentions/external root \"flarum.reg.get('core', 'common/extend')\"","webpack://@flarum/mentions/external root \"flarum.reg.get('core', 'forum/app')\"","webpack://@flarum/mentions/external root \"flarum.reg.get('core', 'common/utils/string')\"","webpack://@flarum/mentions/external root \"flarum.reg.get('core', 'common/helpers/textContrastClass')\"","webpack://@flarum/mentions/external root \"flarum.reg.get('core', 'forum/components/Post')\"","webpack://@flarum/mentions/external root \"flarum.reg.get('core', 'forum/components/CommentPost')\"","webpack://@flarum/mentions/external root \"flarum.reg.get('core', 'forum/components/PostPreview')\"","webpack://@flarum/mentions/external root \"flarum.reg.get('core', 'common/components/LoadingIndicator')\"","webpack://@flarum/mentions/external root \"flarum.reg.get('core', 'common/components/Link')\"","webpack://@flarum/mentions/external root \"flarum.reg.get('core', 'common/helpers/punctuateSeries')\"","webpack://@flarum/mentions/external root \"flarum.reg.get('core', 'common/helpers/username')\"","webpack://@flarum/mentions/external root \"flarum.reg.get('core', 'common/components/Icon')\"","webpack://@flarum/mentions/external root \"flarum.reg.get('core', 'common/components/Button')\"","webpack://@flarum/mentions/external root \"flarum.reg.get('core', 'common/components/Modal')\"","webpack://@flarum/mentions/../../../node_modules/@babel/runtime/helpers/esm/typeof.js","webpack://@flarum/mentions/../../../node_modules/@babel/runtime/helpers/esm/defineProperty.js","webpack://@flarum/mentions/../../../node_modules/@babel/runtime/helpers/esm/toPropertyKey.js","webpack://@flarum/mentions/../../../node_modules/@babel/runtime/helpers/esm/toPrimitive.js","webpack://@flarum/mentions/external root \"flarum.reg.get('core', 'common/states/PaginatedListState')\"","webpack://@flarum/mentions/./src/forum/state/MentionedByModalState.ts","webpack://@flarum/mentions/external root \"flarum.reg.get('core', 'common/components/Form')\"","webpack://@flarum/mentions/./src/forum/components/MentionedByModal.tsx","webpack://@flarum/mentions/external root \"flarum.reg.get('core', 'forum/utils/DiscussionControls')\"","webpack://@flarum/mentions/./src/forum/utils/reply.js","webpack://@flarum/mentions/external root \"flarum.reg.get('core', 'common/Fragment')\"","webpack://@flarum/mentions/./src/forum/fragments/PostQuoteButton.js","webpack://@flarum/mentions/./src/forum/utils/selectedText.js","webpack://@flarum/mentions/external root \"flarum.reg.get('core', 'common/components/TextEditorButton')\"","webpack://@flarum/mentions/external root \"flarum.reg.get('core', 'common/utils/KeyboardNavigatable')\"","webpack://@flarum/mentions/external root \"flarum.reg.get('core', 'common/utils/AutocompleteReader')\"","webpack://@flarum/mentions/external root \"flarum.reg.get('core', 'common/utils/throttleDebounce')\"","webpack://@flarum/mentions/./src/forum/fragments/AutocompleteDropdown.js","webpack://@flarum/mentions/../../../node_modules/@babel/runtime/helpers/esm/objectWithoutProperties.js","webpack://@flarum/mentions/../../../node_modules/@babel/runtime/helpers/esm/objectWithoutPropertiesLoose.js","webpack://@flarum/mentions/external root \"flarum.reg.get('core', 'common/Component')\"","webpack://@flarum/mentions/external root \"flarum.reg.get('core', 'common/utils/classList')\"","webpack://@flarum/mentions/./src/forum/components/MentionsDropdownItem.tsx","webpack://@flarum/mentions/./src/forum/mentionables/MentionableModels.tsx","webpack://@flarum/mentions/./src/forum/mentionables/formats/MentionFormat.ts","webpack://@flarum/mentions/external root \"flarum.reg.get('core', 'common/components/Avatar')\"","webpack://@flarum/mentions/external root \"flarum.reg.get('core', 'common/helpers/highlight')\"","webpack://@flarum/mentions/./src/forum/mentionables/MentionableModel.ts","webpack://@flarum/mentions/external root \"flarum.reg.get('core', 'common/utils/extractText')\"","webpack://@flarum/mentions/./src/forum/utils/getCleanDisplayName.js","webpack://@flarum/mentions/./src/forum/mentionables/UserMention.tsx","webpack://@flarum/mentions/./src/forum/mentionables/PostMention.tsx","webpack://@flarum/mentions/external root \"flarum.reg.get('core', 'common/models/Group')\"","webpack://@flarum/mentions/external root \"flarum.reg.get('core', 'common/components/Badge')\"","webpack://@flarum/mentions/./src/forum/mentionables/GroupMention.tsx","webpack://@flarum/mentions/./src/forum/mentionables/formats/AtMentionFormat.ts","webpack://@flarum/mentions/./src/forum/mentionables/TagMention.tsx","webpack://@flarum/mentions/./src/forum/mentionables/formats/HashMentionFormat.ts","webpack://@flarum/mentions/./src/forum/mentionables/formats/MentionFormats.ts","webpack://@flarum/mentions/external root \"flarum.reg.get('core', 'forum/components/UserPage')\"","webpack://@flarum/mentions/external root \"flarum.reg.get('core', 'common/components/LinkButton')\"","webpack://@flarum/mentions/external root \"flarum.reg.get('core', 'common/extenders')\"","webpack://@flarum/mentions/external root \"flarum.reg.get('core', 'common/models/Post')\"","webpack://@flarum/mentions/external root \"flarum.reg.get('core', 'common/models/User')\"","webpack://@flarum/mentions/external root \"flarum.reg.get('core', 'forum/components/PostsUserPage')\"","webpack://@flarum/mentions/./src/forum/components/MentionsUserPage.ts","webpack://@flarum/mentions/external root \"flarum.reg.get('core', 'forum/components/Notification')\"","webpack://@flarum/mentions/./src/forum/components/PostMentionedNotification.js","webpack://@flarum/mentions/./src/forum/components/UserMentionedNotification.js","webpack://@flarum/mentions/./src/forum/components/GroupMentionedNotification.js","webpack://@flarum/mentions/external root \"flarum.reg.get('core', 'common/query/IGambit')\"","webpack://@flarum/mentions/external root \"flarum.reg.get('core', 'common/app')\"","webpack://@flarum/mentions/./src/common/query/posts/MentionedGambit.ts","webpack://@flarum/mentions/./src/common/extend.ts","webpack://@flarum/mentions/./src/forum/extend.ts","webpack://@flarum/mentions/./src/forum/utils/textFormatter.js","webpack://@flarum/mentions/./src/forum/extenders/Mentionables.ts","webpack://@flarum/mentions/./src/forum/index.js","webpack://@flarum/mentions/./src/forum/addPostMentionPreviews.js","webpack://@flarum/mentions/./src/forum/addMentionedByList.js","webpack://@flarum/mentions/./src/forum/addPostReplyAction.js","webpack://@flarum/mentions/./src/forum/addPostQuoteButton.js","webpack://@flarum/mentions/./src/forum/addComposerAutocomplete.js"],"sourcesContent":["// The require scope\nvar __webpack_require__ = {};\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.reg.get('core', 'common/extend');","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.reg.get('core', 'forum/app');","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.reg.get('core', 'common/utils/string');","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.reg.get('core', 'common/helpers/textContrastClass');","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.reg.get('core', 'forum/components/Post');","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.reg.get('core', 'forum/components/CommentPost');","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.reg.get('core', 'forum/components/PostPreview');","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.reg.get('core', 'common/components/LoadingIndicator');","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.reg.get('core', 'common/components/Link');","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.reg.get('core', 'common/helpers/punctuateSeries');","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.reg.get('core', 'common/helpers/username');","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.reg.get('core', 'common/components/Icon');","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.reg.get('core', 'common/components/Button');","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.reg.get('core', 'common/components/Modal');","function _typeof(o) {\n  \"@babel/helpers - typeof\";\n\n  return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (o) {\n    return typeof o;\n  } : function (o) {\n    return o && \"function\" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? \"symbol\" : typeof o;\n  }, _typeof(o);\n}\nexport { _typeof as default };","import toPropertyKey from \"./toPropertyKey.js\";\nfunction _defineProperty(e, r, t) {\n  return (r = toPropertyKey(r)) in e ? Object.defineProperty(e, r, {\n    value: t,\n    enumerable: !0,\n    configurable: !0,\n    writable: !0\n  }) : e[r] = t, e;\n}\nexport { _defineProperty as default };","import _typeof from \"./typeof.js\";\nimport toPrimitive from \"./toPrimitive.js\";\nfunction toPropertyKey(t) {\n  var i = toPrimitive(t, \"string\");\n  return \"symbol\" == _typeof(i) ? i : i + \"\";\n}\nexport { toPropertyKey as default };","import _typeof from \"./typeof.js\";\nfunction toPrimitive(t, r) {\n  if (\"object\" != _typeof(t) || !t) return t;\n  var e = t[Symbol.toPrimitive];\n  if (void 0 !== e) {\n    var i = e.call(t, r || \"default\");\n    if (\"object\" != _typeof(i)) return i;\n    throw new TypeError(\"@@toPrimitive must return a primitive value.\");\n  }\n  return (\"string\" === r ? String : Number)(t);\n}\nexport { toPrimitive as default };","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.reg.get('core', 'common/states/PaginatedListState');","import _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nfunction ownKeys(e, r) { var t = Object.keys(e); if (Object.getOwnPropertySymbols) { var o = Object.getOwnPropertySymbols(e); r && (o = o.filter(function (r) { return Object.getOwnPropertyDescriptor(e, r).enumerable; })), t.push.apply(t, o); } return t; }\nfunction _objectSpread(e) { for (var r = 1; r < arguments.length; r++) { var t = null != arguments[r] ? arguments[r] : {}; r % 2 ? ownKeys(Object(t), !0).forEach(function (r) { _defineProperty(e, r, t[r]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(t)) : ownKeys(Object(t)).forEach(function (r) { Object.defineProperty(e, r, Object.getOwnPropertyDescriptor(t, r)); }); } return e; }\nimport PaginatedListState from 'flarum/common/states/PaginatedListState';\nexport default class MentionedByModalState extends PaginatedListState {\n  constructor(params, page) {\n    if (page === void 0) {\n      page = 1;\n    }\n    const limit = 10;\n    params.page = _objectSpread(_objectSpread({}, params.page || {}), {}, {\n      limit\n    });\n    super(params, page, limit);\n  }\n  get type() {\n    return 'posts';\n  }\n}\nflarum.reg.add('flarum-mentions', 'forum/state/MentionedByModalState', MentionedByModalState);","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.reg.get('core', 'common/components/Form');","import app from 'flarum/forum/app';\nimport PostPreview from 'flarum/forum/components/PostPreview';\nimport Modal from 'flarum/common/components/Modal';\nimport LoadingIndicator from 'flarum/common/components/LoadingIndicator';\nimport Button from 'flarum/common/components/Button';\nimport MentionedByModalState from '../state/MentionedByModalState';\nimport Form from 'flarum/common/components/Form';\nexport default class MentionedByModal extends Modal {\n  oninit(vnode) {\n    super.oninit(vnode);\n    this.state = new MentionedByModalState({\n      filter: {\n        mentionedPost: this.attrs.post.id()\n      },\n      sort: 'number'\n    });\n    this.state.refresh();\n  }\n  className() {\n    return 'MentionedByModal';\n  }\n  title() {\n    return app.translator.trans('flarum-mentions.forum.mentioned_by.title');\n  }\n  content() {\n    return m('[', null, m(\"div\", {\n      className: \"Modal-body\"\n    }, this.state.isInitialLoading() ? m(LoadingIndicator, null) : m('[', null, m(\"ul\", {\n      className: \"MentionedByModal-list Dropdown-menu Dropdown-menu--inline Post-mentionedBy-preview\"\n    }, this.state.getPages().map(page => page.items.map(reply => m(\"li\", {\n      \"data-number\": reply.number()\n    }, m(PostPreview, {\n      post: reply,\n      onclick: () => app.modal.close()\n    }))))))), this.state.hasNext() && m(\"div\", {\n      className: \"Modal-footer\"\n    }, m(Form, {\n      className: \"Form--centered\"\n    }, m(\"div\", {\n      className: \"Form-group\"\n    }, m(Button, {\n      className: \"Button Button--block\",\n      onclick: () => this.state.loadNext(),\n      loading: this.state.isLoadingNext()\n    }, app.translator.trans('flarum-mentions.forum.mentioned_by.load_more_button'))))));\n  }\n}\nflarum.reg.add('flarum-mentions', 'forum/components/MentionedByModal', MentionedByModal);","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.reg.get('core', 'forum/utils/DiscussionControls');","import app from 'flarum/forum/app';\nimport DiscussionControls from 'flarum/forum/utils/DiscussionControls';\nexport function insertMention(post, composer, quote) {\n  return new Promise(resolve => {\n    const mention = app.mentionFormats.mentionable('post').replacement(post) + ' ';\n\n    // If the composer is empty, then assume we're starting a new reply.\n    // In which case we don't want the user to have to confirm if they\n    // close the composer straight away.\n    if (!composer.fields.content()) {\n      composer.body.attrs.originalContent = mention;\n    }\n    const cursorPosition = composer.editor.getSelectionRange()[0];\n    const preceding = composer.fields.content().slice(0, cursorPosition);\n    const precedingNewlines = preceding.length == 0 ? 0 : 3 - preceding.match(/(\\n{0,2})$/)[0].length;\n    composer.editor.insertAtCursor(Array(precedingNewlines).join('\\n') + (\n    // Insert up to two newlines, depending on preceding whitespace\n    quote ? '> ' + mention + quote.trim().replace(/\\n/g, '\\n> ') + '\\n\\n' : mention), false);\n    return resolve(composer);\n  });\n}\nexport default function reply(post, quote) {\n  if (app.composer.bodyMatches('flarum/forum/components/EditPostComposer') && app.composer.body.attrs.post.discussion() === post.discussion()) {\n    // If we're already editing a post in the discussion of post we're quoting,\n    // insert the mention directly.\n    return insertMention(post, app.composer, quote);\n  } else {\n    // The default \"Reply\" action behavior will only open a new composer if\n    // necessary, but it will always be a ReplyComposer, hence the exceptional\n    // case above.\n    return DiscussionControls.replyAction.call(post.discussion()).then(composer => insertMention(post, composer, quote));\n  }\n}\nflarum.reg.add('flarum-mentions', 'forum/utils/reply', reply);","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.reg.get('core', 'common/Fragment');","import app from 'flarum/forum/app';\nimport Fragment from 'flarum/common/Fragment';\nimport Icon from 'flarum/common/components/Icon';\nimport reply from '../utils/reply';\nexport default class PostQuoteButton extends Fragment {\n  constructor(post) {\n    super();\n    this.post = post;\n  }\n  view() {\n    return m(\"button\", {\n      className: \"Button PostQuoteButton\",\n      type: \"button\",\n      onclick: () => {\n        reply(this.post, this.content);\n      }\n    }, m(Icon, {\n      name: \"fas fa-quote-left\",\n      className: \"Button-icon\"\n    }), app.translator.trans('flarum-mentions.forum.post.quote_button'));\n  }\n  show(left, top) {\n    const $this = this.$().show();\n    const parentOffset = $this.offsetParent().offset();\n    $this.css('left', left - parentOffset.left).css('top', top - parentOffset.top);\n    this.hideHandler = this.hide.bind(this);\n    $(document).on('mouseup', this.hideHandler);\n  }\n  showStart(left, top) {\n    const $this = this.$();\n    this.show(left, $(window).scrollTop() + top - $this.outerHeight() - 5);\n  }\n  showEnd(right, bottom) {\n    const $this = this.$();\n    this.show(right - $this.outerWidth(), $(window).scrollTop() + bottom + 5);\n  }\n  hide() {\n    this.$().hide();\n    $(document).off('mouseup', this.hideHandler);\n  }\n}\nflarum.reg.add('flarum-mentions', 'forum/fragments/PostQuoteButton', PostQuoteButton);","/**\n * Finds the selected text in the provided composer body.\n */\nexport default function selectedText(body) {\n  const selection = window.getSelection();\n  if (!selection.isCollapsed) {\n    const range = selection.getRangeAt(0);\n    const parent = range.commonAncestorContainer;\n    if (body[0] === parent || $.contains(body[0], parent)) {\n      const clone = $('<div>').append(range.cloneContents());\n\n      // Replace emoji images with their shortcode (found in alt attribute)\n      clone.find('img.emoji').replaceWith(function () {\n        return this.alt;\n      });\n\n      // Replace all other images with a Markdown image\n      clone.find('img').replaceWith(function () {\n        return \"![](\".concat(this.src, \")\");\n      });\n\n      // Replace all links with a Markdown link\n      clone.find('a').replaceWith(function () {\n        return \"[\".concat(this.innerText, \"](\").concat(this.href, \")\");\n      });\n      return clone.text();\n    }\n  }\n  return '';\n}\nflarum.reg.add('flarum-mentions', 'forum/utils/selectedText', selectedText);","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.reg.get('core', 'common/components/TextEditorButton');","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.reg.get('core', 'common/utils/KeyboardNavigatable');","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.reg.get('core', 'common/utils/AutocompleteReader');","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.reg.get('core', 'common/utils/throttleDebounce');","import _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport Fragment from 'flarum/common/Fragment';\nexport default class AutocompleteDropdown extends Fragment {\n  constructor() {\n    super(...arguments);\n    _defineProperty(this, \"items\", []);\n    _defineProperty(this, \"active\", false);\n    _defineProperty(this, \"index\", 0);\n    _defineProperty(this, \"keyWasJustPressed\", false);\n  }\n  view() {\n    return m(\"ul\", {\n      className: \"Dropdown-menu MentionsDropdown\"\n    }, this.items.map(item => m(\"li\", null, item)));\n  }\n  show(left, top) {\n    this.$().show().css({\n      left: left + 'px',\n      top: top + 'px'\n    });\n    this.active = true;\n  }\n  hide() {\n    this.$().hide();\n    this.active = false;\n  }\n  navigate(delta) {\n    this.keyWasJustPressed = true;\n    this.setIndex(this.index + delta, true);\n    clearTimeout(this.keyWasJustPressedTimeout);\n    this.keyWasJustPressedTimeout = setTimeout(() => this.keyWasJustPressed = false, 500);\n  }\n  complete() {\n    this.$('li').eq(this.index).find('button').click();\n  }\n  setIndex(index, scrollToItem) {\n    if (this.keyWasJustPressed && !scrollToItem) return;\n    const $dropdown = this.$();\n    const $items = $dropdown.find('li');\n    let rangedIndex = index;\n    if (rangedIndex < 0) {\n      rangedIndex = $items.length - 1;\n    } else if (rangedIndex >= $items.length) {\n      rangedIndex = 0;\n    }\n    this.index = rangedIndex;\n    const $item = $items.removeClass('active').eq(rangedIndex).addClass('active');\n    if (scrollToItem) {\n      const dropdownScroll = $dropdown.scrollTop();\n      const dropdownTop = $dropdown.offset().top;\n      const dropdownBottom = dropdownTop + $dropdown.outerHeight();\n      const itemTop = $item.offset().top;\n      const itemBottom = itemTop + $item.outerHeight();\n      let scrollTop;\n      if (itemTop < dropdownTop) {\n        scrollTop = dropdownScroll - dropdownTop + itemTop - parseInt($dropdown.css('padding-top'), 10);\n      } else if (itemBottom > dropdownBottom) {\n        scrollTop = dropdownScroll - dropdownBottom + itemBottom + parseInt($dropdown.css('padding-bottom'), 10);\n      }\n      if (typeof scrollTop !== 'undefined') {\n        $dropdown.stop(true).animate({\n          scrollTop\n        }, 100);\n      }\n    }\n  }\n}\nflarum.reg.add('flarum-mentions', 'forum/fragments/AutocompleteDropdown', AutocompleteDropdown);","import objectWithoutPropertiesLoose from \"./objectWithoutPropertiesLoose.js\";\nfunction _objectWithoutProperties(e, t) {\n  if (null == e) return {};\n  var o,\n    r,\n    i = objectWithoutPropertiesLoose(e, t);\n  if (Object.getOwnPropertySymbols) {\n    var n = Object.getOwnPropertySymbols(e);\n    for (r = 0; r < n.length; r++) o = n[r], -1 === t.indexOf(o) && {}.propertyIsEnumerable.call(e, o) && (i[o] = e[o]);\n  }\n  return i;\n}\nexport { _objectWithoutProperties as default };","function _objectWithoutPropertiesLoose(r, e) {\n  if (null == r) return {};\n  var t = {};\n  for (var n in r) if ({}.hasOwnProperty.call(r, n)) {\n    if (-1 !== e.indexOf(n)) continue;\n    t[n] = r[n];\n  }\n  return t;\n}\nexport { _objectWithoutPropertiesLoose as default };","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.reg.get('core', 'common/Component');","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.reg.get('core', 'common/utils/classList');","import _objectWithoutProperties from \"@babel/runtime/helpers/esm/objectWithoutProperties\";\nconst _excluded = [\"mentionable\"];\nimport Component from 'flarum/common/Component';\nimport classList from 'flarum/common/utils/classList';\nexport default class MentionsDropdownItem extends Component {\n  view(vnode) {\n    const _this$attrs = this.attrs,\n      {\n        mentionable\n      } = _this$attrs,\n      attrs = _objectWithoutProperties(_this$attrs, _excluded);\n    const className = classList('MentionsDropdownItem', 'PostPreview', \"MentionsDropdown-\".concat(mentionable.type()));\n    return m(\"button\", Object.assign({\n      className: className,\n      type: \"button\"\n    }, attrs), m(\"span\", {\n      className: \"PostPreview-content\"\n    }, vnode.children));\n  }\n}\nflarum.reg.add('flarum-mentions', 'forum/components/MentionsDropdownItem', MentionsDropdownItem);","import _objectWithoutProperties from \"@babel/runtime/helpers/esm/objectWithoutProperties\";\nimport _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nconst _excluded = [\"onclick\"];\nimport MentionsDropdownItem from '../components/MentionsDropdownItem';\nexport default class MentionableModels {\n  constructor(dropdownItemAttrs) {\n    _defineProperty(this, \"mentionables\", void 0);\n    /**\n     * We store models returned from an API here to preserve order in which they are returned\n     * This prevents the list jumping around while models are returned.\n     * We also use a hashmap for model IDs to provide O(1) lookup for the users already in the list.\n     */\n    _defineProperty(this, \"results\", {});\n    _defineProperty(this, \"typed\", null);\n    _defineProperty(this, \"searched\", []);\n    _defineProperty(this, \"dropdownItemAttrs\", {});\n    /**\n     * Don't send API calls searching for models until at least 2 characters have been typed.\n     * This focuses the mention results on models already loaded.\n     */\n    _defineProperty(this, \"search\", async () => {\n      if (!this.typed || this.typed.length <= 1) return;\n      const typedLower = this.typed.toLowerCase();\n      if (this.searched.includes(typedLower)) return;\n      for (const mentionable of this.mentionables) {\n        for (const model of await mentionable.search(typedLower)) {\n          if (!this.results[mentionable.type()].has(model.id())) {\n            this.results[mentionable.type()].set(model.id(), model);\n          }\n        }\n      }\n      this.searched.push(typedLower);\n      return Promise.resolve();\n    });\n    this.dropdownItemAttrs = dropdownItemAttrs;\n  }\n  init(mentionables) {\n    this.typed = null;\n    this.mentionables = mentionables;\n    for (const mentionable of this.mentionables) {\n      this.results[mentionable.type()] = new Map(mentionable.initialResults().map(result => [result.id(), result]));\n    }\n  }\n  matches(mentionable, model) {\n    var _this$typed;\n    return mentionable.matches(model, ((_this$typed = this.typed) == null ? void 0 : _this$typed.toLowerCase()) || '');\n  }\n  makeSuggestion(mentionable, model) {\n    const content = mentionable.suggestion(model, this.typed);\n    const replacement = mentionable.replacement(model);\n    const _this$dropdownItemAtt = this.dropdownItemAttrs,\n      {\n        onclick\n      } = _this$dropdownItemAtt,\n      attrs = _objectWithoutProperties(_this$dropdownItemAtt, _excluded);\n    return m(MentionsDropdownItem, Object.assign({\n      mentionable: mentionable,\n      onclick: () => onclick(replacement)\n    }, attrs), content);\n  }\n  buildSuggestions() {\n    const suggestions = [];\n    for (const mentionable of this.mentionables) {\n      if (!mentionable.enabled()) continue;\n      let matches = Array.from(this.results[mentionable.type()].values()).filter(model => this.matches(mentionable, model));\n      const max = mentionable.maxStoreMatchedResults();\n      if (max) matches = matches.splice(0, max);\n      for (const model of matches) {\n        const dropdownItem = this.makeSuggestion(mentionable, model);\n        suggestions.push(dropdownItem);\n      }\n    }\n    return suggestions;\n  }\n}\nflarum.reg.add('flarum-mentions', 'forum/mentionables/MentionableModels', MentionableModels);","import _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nexport default class MentionFormat {\n  constructor() {\n    _defineProperty(this, \"instances\", void 0);\n    _defineProperty(this, \"mentionables\", void 0);\n    _defineProperty(this, \"extendable\", void 0);\n  }\n  makeMentionables() {\n    var _this$instances;\n    return (_this$instances = this.instances) != null ? _this$instances : this.instances = this.mentionables.map(Mentionable => new Mentionable(this));\n  }\n  getMentionable(type) {\n    var _this$makeMentionable;\n    return (_this$makeMentionable = this.makeMentionables().find(mentionable => mentionable.type() === type)) != null ? _this$makeMentionable : null;\n  }\n  extend(mentionable) {\n    if (!this.extendable) throw new Error('This mention format does not allow extending.');\n    this.mentionables.push(mentionable);\n  }\n\n  /**\n   * Picks the term to search in the API from the typed text.\n   * @example:\n   *  * Full text = `Hello @\"John D`\n   *  * Typed text = `\"John D`\n   *  * Query = `John D`\n   */\n}\nflarum.reg.add('flarum-mentions', 'forum/mentionables/formats/MentionFormat', MentionFormat);","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.reg.get('core', 'common/components/Avatar');","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.reg.get('core', 'common/helpers/highlight');","import _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nexport default class MentionableModel {\n  constructor(format) {\n    _defineProperty(this, \"format\", void 0);\n    this.format = format;\n  }\n}\nflarum.reg.add('flarum-mentions', 'forum/mentionables/MentionableModel', MentionableModel);","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.reg.get('core', 'common/utils/extractText');","import app from 'flarum/forum/app';\nimport extractText from 'flarum/common/utils/extractText';\n\n/**\n * Whether to use the old mentions format.\n *\n * `'@username'` or `'@\"Display name\"'`\n */\nexport const shouldUseOldFormat = () => app.forum.attribute('allowUsernameMentionFormat') || false;\nconst getDeletedUserText = () => extractText(app.translator.trans('core.lib.username.deleted_text'));\n\n/**\n * Fetches a user's username or display name.\n *\n * Chooses based on the format option set in the admin settings page.\n *\n * @param user An instance of the User model to fetch the username for\n * @param useDisplayName If `true`, uses `user.displayName()`, otherwise, uses `user.username()`\n */\nexport default function getCleanDisplayName(user, useDisplayName) {\n  if (useDisplayName === void 0) {\n    useDisplayName = true;\n  }\n  if (!user) return getDeletedUserText().replace(/\"#[a-z]{0,3}[0-9]+/, '_');\n  const text = (useDisplayName ? user.displayName() : user.username()) || getDeletedUserText();\n  return text.replace(/\"#[a-z]{0,3}[0-9]+/, '_');\n}\nflarum.reg.add('flarum-mentions', 'forum/utils/getCleanDisplayName', getCleanDisplayName);","import app from 'flarum/forum/app';\nimport usernameHelper from 'flarum/common/helpers/username';\nimport Avatar from 'flarum/common/components/Avatar';\nimport highlight from 'flarum/common/helpers/highlight';\nimport MentionableModel from './MentionableModel';\nimport getCleanDisplayName, { shouldUseOldFormat } from '../utils/getCleanDisplayName';\nexport default class UserMention extends MentionableModel {\n  type() {\n    return 'user';\n  }\n  initialResults() {\n    return Array.from(app.store.all('users'));\n  }\n\n  /**\n   * Automatically determines which mention syntax to be used based on the option in the\n   * admin dashboard. Also performs display name clean-up automatically.\n   *\n   * @\"Display name\"#UserID or `@username`\n   *\n   * @example <caption>New display name syntax</caption>\n   * // '@\"user\"#1'\n   * forUser(User) // User is ID 1, display name is 'User'\n   *\n   * @example <caption>Using old syntax</caption>\n   * // '@username'\n   * forUser(user) // User's username is 'username'\n   */\n  replacement(user) {\n    if (shouldUseOldFormat()) {\n      const cleanText = getCleanDisplayName(user, false);\n      return this.format.format(cleanText);\n    }\n    const cleanText = getCleanDisplayName(user);\n    return this.format.format(cleanText, '', user.id());\n  }\n  suggestion(model, typed) {\n    const username = usernameHelper(model, name => highlight(name, typed));\n    return m('[', null, m(Avatar, {\n      user: model\n    }), username);\n  }\n  matches(model, typed) {\n    if (!typed) return false;\n    const names = [model.username(), model.displayName()];\n    return names.some(name => name.toLowerCase().substr(0, typed.length) === typed);\n  }\n  maxStoreMatchedResults() {\n    return null;\n  }\n  async search(typed) {\n    return await app.store.find('users', {\n      filter: {\n        q: typed\n      },\n      page: {\n        limit: 5\n      }\n    });\n  }\n  enabled() {\n    return true;\n  }\n}\nflarum.reg.add('flarum-mentions', 'forum/mentionables/UserMention', UserMention);","import app from 'flarum/forum/app';\nimport MentionableModel from './MentionableModel';\nimport usernameHelper from 'flarum/common/helpers/username';\nimport Avatar from 'flarum/common/components/Avatar';\nimport highlight from 'flarum/common/helpers/highlight';\nimport { truncate } from 'flarum/common/utils/string';\nimport getCleanDisplayName from '../utils/getCleanDisplayName';\nexport default class PostMention extends MentionableModel {\n  type() {\n    return 'post';\n  }\n\n  /**\n   * If the user is replying to a discussion, or if they are editing a\n   * post, then we can suggest other posts in the discussion to mention.\n   * We will add the 5 most recent comments in the discussion which\n   * match any username characters that have been typed.\n   */\n  initialResults() {\n    if (!app.composer.bodyMatches('flarum/forum/components/ReplyComposer') && !app.composer.bodyMatches('flarum/forum/components/EditPostComposer')) {\n      return [];\n    }\n\n    // @ts-ignore\n    const composerAttrs = app.composer.body.attrs;\n    const composerPost = composerAttrs.post;\n    const discussion = composerPost && composerPost.discussion() || composerAttrs.discussion;\n    return discussion.posts()\n    // Filter to only comment posts, and replies before this message\n    .filter(post => post && post.contentType() === 'comment' && (!composerPost || post.number() < composerPost.number()))\n    // Sort by new to old\n    .sort((a, b) => b.createdAt().getTime() - a.createdAt().getTime());\n  }\n\n  /**\n   * Generates the syntax for mentioning of a post. Also cleans up the display name.\n   *\n   * @example <caption>Post mention</caption>\n   * // '@\"User\"#p13'\n   * // @\"Display name\"#pPostID\n   * forPostMention(user, 13) // User display name is 'User', post ID is 13\n   */\n  replacement(post) {\n    const user = post.user();\n    const cleanText = getCleanDisplayName(user);\n    return this.format.format(cleanText, 'p', post.id());\n  }\n  suggestion(model, typed) {\n    var _model$contentPlain;\n    const user = model.user() || null;\n    const username = usernameHelper(user, name => highlight(name, typed));\n    return m('[', null, m(Avatar, {\n      user: user\n    }), username, [app.translator.trans('flarum-mentions.forum.composer.reply_to_post_text', {\n      number: model.number()\n    }), '  ', truncate((_model$contentPlain = model.contentPlain()) != null ? _model$contentPlain : '', 200)]);\n  }\n  matches(model, typed) {\n    const user = model.user();\n    const userMentionable = app.mentionFormats.mentionable('user');\n    return !typed || user && userMentionable.matches(user, typed);\n  }\n  maxStoreMatchedResults() {\n    return 5;\n  }\n\n  /**\n   * Post mention suggestions are only offered from current discussion posts.\n   */\n  search(typed) {\n    return Promise.resolve([]);\n  }\n  enabled() {\n    return true;\n  }\n}\nflarum.reg.add('flarum-mentions', 'forum/mentionables/PostMention', PostMention);","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.reg.get('core', 'common/models/Group');","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.reg.get('core', 'common/components/Badge');","import app from 'flarum/forum/app';\nimport Group from 'flarum/common/models/Group';\nimport MentionableModel from './MentionableModel';\nimport Badge from 'flarum/common/components/Badge';\nimport highlight from 'flarum/common/helpers/highlight';\nexport default class GroupMention extends MentionableModel {\n  type() {\n    return 'group';\n  }\n  initialResults() {\n    return Array.from(app.store.all('groups').filter(g => {\n      return g.id() !== Group.GUEST_ID && g.id() !== Group.MEMBER_ID;\n    }));\n  }\n\n  /**\n   * Generates the mention syntax for a group mention.\n   *\n   * @\"Name Plural\"#gGroupID\n   *\n   * @example <caption>Group mention</caption>\n   * // '@\"Mods\"#g4'\n   * forGroup(group) // Group display name is 'Mods', group ID is 4\n   */\n  replacement(group) {\n    return this.format.format(group.namePlural(), 'g', group.id());\n  }\n  suggestion(model, typed) {\n    let groupName = model.namePlural();\n    if (typed) {\n      groupName = highlight(groupName, typed);\n    }\n    return m('[', null, m(Badge, {\n      className: \"Avatar Badge Badge--group--\".concat(model.id(), \" Badge-icon\"),\n      color: model.color(),\n      type: \"group\",\n      icon: model.icon()\n    }), m(\"span\", {\n      className: \"username\"\n    }, groupName));\n  }\n  matches(model, typed) {\n    if (!typed) return false;\n    const names = [model.namePlural().toLowerCase(), model.nameSingular().toLowerCase()];\n    return names.some(name => name.toLowerCase().substr(0, typed.length) === typed);\n  }\n  maxStoreMatchedResults() {\n    return null;\n  }\n\n  /**\n   * All groups are already loaded, so we don't need to search for them.\n   */\n  search(typed) {\n    return Promise.resolve([]);\n  }\n  enabled() {\n    var _app$session$user$can, _app$session;\n    return (_app$session$user$can = (_app$session = app.session) == null || (_app$session = _app$session.user) == null ? void 0 : _app$session.canMentionGroups()) != null ? _app$session$user$can : false;\n  }\n}\nflarum.reg.add('flarum-mentions', 'forum/mentionables/GroupMention', GroupMention);","import _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport MentionFormat from './MentionFormat';\nimport UserMention from '../UserMention';\nimport PostMention from '../PostMention';\nimport GroupMention from '../GroupMention';\nexport default class AtMentionFormat extends MentionFormat {\n  constructor() {\n    super(...arguments);\n    _defineProperty(this, \"mentionables\", [UserMention, PostMention, GroupMention]);\n    _defineProperty(this, \"extendable\", true);\n  }\n  trigger() {\n    return '@';\n  }\n  queryFromTyped(typed) {\n    const matchTyped = typed.match(/^[\"]?((?:(?!\"#).)+)$/);\n    return matchTyped ? matchTyped[1] : null;\n  }\n  format(name, char, id) {\n    if (char === void 0) {\n      char = '';\n    }\n    if (id === void 0) {\n      id = null;\n    }\n    return {\n      simple: \"@\".concat(name),\n      safe: \"@\\\"\".concat(name, \"\\\"#\").concat(char).concat(id)\n    }[id ? 'safe' : 'simple'];\n  }\n}\nflarum.reg.add('flarum-mentions', 'forum/mentionables/formats/AtMentionFormat', AtMentionFormat);","import app from 'flarum/forum/app';\nimport Badge from 'flarum/common/components/Badge';\nimport highlight from 'flarum/common/helpers/highlight';\nimport MentionableModel from './MentionableModel';\nexport default class TagMention extends MentionableModel {\n  type() {\n    return 'tag';\n  }\n  initialResults() {\n    return Array.from(app.store.all('tags'));\n  }\n\n  /**\n   * Generates the mention syntax for a tag mention.\n   *\n   * ~tagSlug\n   *\n   * @example <caption>Tag mention</caption>\n   * // ~general\n   * forTag(tag) // Tag display name is 'Tag', tag ID is 5\n   */\n  replacement(tag) {\n    return this.format.format(tag.slug());\n  }\n  matches(model, typed) {\n    if (!typed) return false;\n    const names = [model.name().toLowerCase()];\n    return names.some(name => name.toLowerCase().substr(0, typed.length) === typed);\n  }\n  maxStoreMatchedResults() {\n    return null;\n  }\n  async search(typed) {\n    return await app.store.find('tags', {\n      filter: {\n        q: typed\n      },\n      page: {\n        limit: 5\n      }\n    });\n  }\n  suggestion(model, typed) {\n    let tagName = model.name();\n    if (typed) {\n      tagName = highlight(tagName, typed);\n    }\n    return m('[', null, m(Badge, {\n      className: \"Avatar\",\n      icon: model.icon(),\n      color: model.color(),\n      type: \"tag\"\n    }), m(\"span\", {\n      className: \"username\"\n    }, tagName));\n  }\n  enabled() {\n    return 'flarum-tags' in flarum.extensions;\n  }\n}\nflarum.reg.add('flarum-mentions', 'forum/mentionables/TagMention', TagMention);","import _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport MentionFormat from './MentionFormat';\nimport TagMention from '../TagMention';\nexport default class HashMentionFormat extends MentionFormat {\n  constructor() {\n    super(...arguments);\n    _defineProperty(this, \"mentionables\", [TagMention]);\n    _defineProperty(this, \"extendable\", true);\n  }\n  trigger() {\n    return '#';\n  }\n  queryFromTyped(typed) {\n    const matchTyped = typed.match(/^(?:[\\x2D0-9A-Z_a-z\\xAA\\xB2\\xB3\\xB5\\xB9\\xBA\\xBC-\\xBE\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0300-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u0483-\\u052F\\u0531-\\u0556\\u0559\\u0560-\\u0588\\u0591-\\u05BD\\u05BF\\u05C1\\u05C2\\u05C4\\u05C5\\u05C7\\u05D0-\\u05EA\\u05EF-\\u05F2\\u0610-\\u061A\\u0620-\\u0669\\u066E-\\u06D3\\u06D5-\\u06DC\\u06DF-\\u06E8\\u06EA-\\u06FC\\u06FF\\u0710-\\u074A\\u074D-\\u07B1\\u07C0-\\u07F5\\u07FA\\u07FD\\u0800-\\u082D\\u0840-\\u085B\\u0860-\\u086A\\u0870-\\u0887\\u0889-\\u088E\\u0897-\\u08E1\\u08E3-\\u0963\\u0966-\\u096F\\u0971-\\u0983\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BC-\\u09C4\\u09C7\\u09C8\\u09CB-\\u09CE\\u09D7\\u09DC\\u09DD\\u09DF-\\u09E3\\u09E6-\\u09F1\\u09F4-\\u09F9\\u09FC\\u09FE\\u0A01-\\u0A03\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A3C\\u0A3E-\\u0A42\\u0A47\\u0A48\\u0A4B-\\u0A4D\\u0A51\\u0A59-\\u0A5C\\u0A5E\\u0A66-\\u0A75\\u0A81-\\u0A83\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABC-\\u0AC5\\u0AC7-\\u0AC9\\u0ACB-\\u0ACD\\u0AD0\\u0AE0-\\u0AE3\\u0AE6-\\u0AEF\\u0AF9-\\u0AFF\\u0B01-\\u0B03\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3C-\\u0B44\\u0B47\\u0B48\\u0B4B-\\u0B4D\\u0B55-\\u0B57\\u0B5C\\u0B5D\\u0B5F-\\u0B63\\u0B66-\\u0B6F\\u0B71-\\u0B77\\u0B82\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BBE-\\u0BC2\\u0BC6-\\u0BC8\\u0BCA-\\u0BCD\\u0BD0\\u0BD7\\u0BE6-\\u0BF2\\u0C00-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3C-\\u0C44\\u0C46-\\u0C48\\u0C4A-\\u0C4D\\u0C55\\u0C56\\u0C58-\\u0C5A\\u0C5D\\u0C60-\\u0C63\\u0C66-\\u0C6F\\u0C78-\\u0C7E\\u0C80-\\u0C83\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBC-\\u0CC4\\u0CC6-\\u0CC8\\u0CCA-\\u0CCD\\u0CD5\\u0CD6\\u0CDD\\u0CDE\\u0CE0-\\u0CE3\\u0CE6-\\u0CEF\\u0CF1-\\u0CF3\\u0D00-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D44\\u0D46-\\u0D48\\u0D4A-\\u0D4E\\u0D54-\\u0D63\\u0D66-\\u0D78\\u0D7A-\\u0D7F\\u0D81-\\u0D83\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0DCA\\u0DCF-\\u0DD4\\u0DD6\\u0DD8-\\u0DDF\\u0DE6-\\u0DEF\\u0DF2\\u0DF3\\u0E01-\\u0E3A\\u0E40-\\u0E4E\\u0E50-\\u0E59\\u0E81\\u0E82\\u0E84\\u0E86-\\u0E8A\\u0E8C-\\u0EA3\\u0EA5\\u0EA7-\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EC8-\\u0ECE\\u0ED0-\\u0ED9\\u0EDC-\\u0EDF\\u0F00\\u0F18\\u0F19\\u0F20-\\u0F33\\u0F35\\u0F37\\u0F39\\u0F3E-\\u0F47\\u0F49-\\u0F6C\\u0F71-\\u0F84\\u0F86-\\u0F97\\u0F99-\\u0FBC\\u0FC6\\u1000-\\u1049\\u1050-\\u109D\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u135D-\\u135F\\u1369-\\u137C\\u1380-\\u138F\\u13A0-\\u13F5\\u13F8-\\u13FD\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u1715\\u171F-\\u1734\\u1740-\\u1753\\u1760-\\u176C\\u176E-\\u1770\\u1772\\u1773\\u1780-\\u17D3\\u17D7\\u17DC\\u17DD\\u17E0-\\u17E9\\u17F0-\\u17F9\\u180B-\\u180D\\u180F-\\u1819\\u1820-\\u1878\\u1880-\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1920-\\u192B\\u1930-\\u193B\\u1946-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19B0-\\u19C9\\u19D0-\\u19DA\\u1A00-\\u1A1B\\u1A20-\\u1A5E\\u1A60-\\u1A7C\\u1A7F-\\u1A89\\u1A90-\\u1A99\\u1AA7\\u1AB0-\\u1ACE\\u1B00-\\u1B4C\\u1B50-\\u1B59\\u1B6B-\\u1B73\\u1B80-\\u1BF3\\u1C00-\\u1C37\\u1C40-\\u1C49\\u1C4D-\\u1C7D\\u1C80-\\u1C8A\\u1C90-\\u1CBA\\u1CBD-\\u1CBF\\u1CD0-\\u1CD2\\u1CD4-\\u1CFA\\u1D00-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u2070\\u2071\\u2074-\\u2079\\u207F-\\u2089\\u2090-\\u209C\\u20D0-\\u20F0\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2150-\\u2189\\u2460-\\u249B\\u24EA-\\u24FF\\u2776-\\u2793\\u2C00-\\u2CE4\\u2CEB-\\u2CF3\\u2CFD\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D7F-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2DE0-\\u2DFF\\u2E2F\\u3005-\\u3007\\u3021-\\u302F\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u3099\\u309A\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312F\\u3131-\\u318E\\u3192-\\u3195\\u31A0-\\u31BF\\u31F0-\\u31FF\\u3220-\\u3229\\u3248-\\u324F\\u3251-\\u325F\\u3280-\\u3289\\u32B1-\\u32BF\\u3400-\\u4DBF\\u4E00-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA62B\\uA640-\\uA672\\uA674-\\uA67D\\uA67F-\\uA6F1\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA7CD\\uA7D0\\uA7D1\\uA7D3\\uA7D5-\\uA7DC\\uA7F2-\\uA827\\uA82C\\uA830-\\uA835\\uA840-\\uA873\\uA880-\\uA8C5\\uA8D0-\\uA8D9\\uA8E0-\\uA8F7\\uA8FB\\uA8FD-\\uA92D\\uA930-\\uA953\\uA960-\\uA97C\\uA980-\\uA9C0\\uA9CF-\\uA9D9\\uA9E0-\\uA9FE\\uAA00-\\uAA36\\uAA40-\\uAA4D\\uAA50-\\uAA59\\uAA60-\\uAA76\\uAA7A-\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEF\\uAAF2-\\uAAF6\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB69\\uAB70-\\uABEA\\uABEC\\uABED\\uABF0-\\uABF9\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE00-\\uFE0F\\uFE20-\\uFE2F\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF10-\\uFF19\\uFF21-\\uFF3A\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]|\\uD800[\\uDC00-\\uDC0B\\uDC0D-\\uDC26\\uDC28-\\uDC3A\\uDC3C\\uDC3D\\uDC3F-\\uDC4D\\uDC50-\\uDC5D\\uDC80-\\uDCFA\\uDD07-\\uDD33\\uDD40-\\uDD78\\uDD8A\\uDD8B\\uDDFD\\uDE80-\\uDE9C\\uDEA0-\\uDED0\\uDEE0-\\uDEFB\\uDF00-\\uDF23\\uDF2D-\\uDF4A\\uDF50-\\uDF7A\\uDF80-\\uDF9D\\uDFA0-\\uDFC3\\uDFC8-\\uDFCF\\uDFD1-\\uDFD5]|\\uD801[\\uDC00-\\uDC9D\\uDCA0-\\uDCA9\\uDCB0-\\uDCD3\\uDCD8-\\uDCFB\\uDD00-\\uDD27\\uDD30-\\uDD63\\uDD70-\\uDD7A\\uDD7C-\\uDD8A\\uDD8C-\\uDD92\\uDD94\\uDD95\\uDD97-\\uDDA1\\uDDA3-\\uDDB1\\uDDB3-\\uDDB9\\uDDBB\\uDDBC\\uDDC0-\\uDDF3\\uDE00-\\uDF36\\uDF40-\\uDF55\\uDF60-\\uDF67\\uDF80-\\uDF85\\uDF87-\\uDFB0\\uDFB2-\\uDFBA]|\\uD802[\\uDC00-\\uDC05\\uDC08\\uDC0A-\\uDC35\\uDC37\\uDC38\\uDC3C\\uDC3F-\\uDC55\\uDC58-\\uDC76\\uDC79-\\uDC9E\\uDCA7-\\uDCAF\\uDCE0-\\uDCF2\\uDCF4\\uDCF5\\uDCFB-\\uDD1B\\uDD20-\\uDD39\\uDD80-\\uDDB7\\uDDBC-\\uDDCF\\uDDD2-\\uDE03\\uDE05\\uDE06\\uDE0C-\\uDE13\\uDE15-\\uDE17\\uDE19-\\uDE35\\uDE38-\\uDE3A\\uDE3F-\\uDE48\\uDE60-\\uDE7E\\uDE80-\\uDE9F\\uDEC0-\\uDEC7\\uDEC9-\\uDEE6\\uDEEB-\\uDEEF\\uDF00-\\uDF35\\uDF40-\\uDF55\\uDF58-\\uDF72\\uDF78-\\uDF91\\uDFA9-\\uDFAF]|\\uD803[\\uDC00-\\uDC48\\uDC80-\\uDCB2\\uDCC0-\\uDCF2\\uDCFA-\\uDD27\\uDD30-\\uDD39\\uDD40-\\uDD65\\uDD69-\\uDD6D\\uDD6F-\\uDD85\\uDE60-\\uDE7E\\uDE80-\\uDEA9\\uDEAB\\uDEAC\\uDEB0\\uDEB1\\uDEC2-\\uDEC4\\uDEFC-\\uDF27\\uDF30-\\uDF54\\uDF70-\\uDF85\\uDFB0-\\uDFCB\\uDFE0-\\uDFF6]|\\uD804[\\uDC00-\\uDC46\\uDC52-\\uDC75\\uDC7F-\\uDCBA\\uDCC2\\uDCD0-\\uDCE8\\uDCF0-\\uDCF9\\uDD00-\\uDD34\\uDD36-\\uDD3F\\uDD44-\\uDD47\\uDD50-\\uDD73\\uDD76\\uDD80-\\uDDC4\\uDDC9-\\uDDCC\\uDDCE-\\uDDDA\\uDDDC\\uDDE1-\\uDDF4\\uDE00-\\uDE11\\uDE13-\\uDE37\\uDE3E-\\uDE41\\uDE80-\\uDE86\\uDE88\\uDE8A-\\uDE8D\\uDE8F-\\uDE9D\\uDE9F-\\uDEA8\\uDEB0-\\uDEEA\\uDEF0-\\uDEF9\\uDF00-\\uDF03\\uDF05-\\uDF0C\\uDF0F\\uDF10\\uDF13-\\uDF28\\uDF2A-\\uDF30\\uDF32\\uDF33\\uDF35-\\uDF39\\uDF3B-\\uDF44\\uDF47\\uDF48\\uDF4B-\\uDF4D\\uDF50\\uDF57\\uDF5D-\\uDF63\\uDF66-\\uDF6C\\uDF70-\\uDF74\\uDF80-\\uDF89\\uDF8B\\uDF8E\\uDF90-\\uDFB5\\uDFB7-\\uDFC0\\uDFC2\\uDFC5\\uDFC7-\\uDFCA\\uDFCC-\\uDFD3\\uDFE1\\uDFE2]|\\uD805[\\uDC00-\\uDC4A\\uDC50-\\uDC59\\uDC5E-\\uDC61\\uDC80-\\uDCC5\\uDCC7\\uDCD0-\\uDCD9\\uDD80-\\uDDB5\\uDDB8-\\uDDC0\\uDDD8-\\uDDDD\\uDE00-\\uDE40\\uDE44\\uDE50-\\uDE59\\uDE80-\\uDEB8\\uDEC0-\\uDEC9\\uDED0-\\uDEE3\\uDF00-\\uDF1A\\uDF1D-\\uDF2B\\uDF30-\\uDF3B\\uDF40-\\uDF46]|\\uD806[\\uDC00-\\uDC3A\\uDCA0-\\uDCF2\\uDCFF-\\uDD06\\uDD09\\uDD0C-\\uDD13\\uDD15\\uDD16\\uDD18-\\uDD35\\uDD37\\uDD38\\uDD3B-\\uDD43\\uDD50-\\uDD59\\uDDA0-\\uDDA7\\uDDAA-\\uDDD7\\uDDDA-\\uDDE1\\uDDE3\\uDDE4\\uDE00-\\uDE3E\\uDE47\\uDE50-\\uDE99\\uDE9D\\uDEB0-\\uDEF8\\uDFC0-\\uDFE0\\uDFF0-\\uDFF9]|\\uD807[\\uDC00-\\uDC08\\uDC0A-\\uDC36\\uDC38-\\uDC40\\uDC50-\\uDC6C\\uDC72-\\uDC8F\\uDC92-\\uDCA7\\uDCA9-\\uDCB6\\uDD00-\\uDD06\\uDD08\\uDD09\\uDD0B-\\uDD36\\uDD3A\\uDD3C\\uDD3D\\uDD3F-\\uDD47\\uDD50-\\uDD59\\uDD60-\\uDD65\\uDD67\\uDD68\\uDD6A-\\uDD8E\\uDD90\\uDD91\\uDD93-\\uDD98\\uDDA0-\\uDDA9\\uDEE0-\\uDEF6\\uDF00-\\uDF10\\uDF12-\\uDF3A\\uDF3E-\\uDF42\\uDF50-\\uDF5A\\uDFB0\\uDFC0-\\uDFD4]|\\uD808[\\uDC00-\\uDF99]|\\uD809[\\uDC00-\\uDC6E\\uDC80-\\uDD43]|\\uD80B[\\uDF90-\\uDFF0]|[\\uD80C\\uD80E\\uD80F\\uD81C-\\uD820\\uD822\\uD840-\\uD868\\uD86A-\\uD86C\\uD86F-\\uD872\\uD874-\\uD879\\uD880-\\uD883\\uD885-\\uD887][\\uDC00-\\uDFFF]|\\uD80D[\\uDC00-\\uDC2F\\uDC40-\\uDC55\\uDC60-\\uDFFF]|\\uD810[\\uDC00-\\uDFFA]|\\uD811[\\uDC00-\\uDE46]|\\uD818[\\uDD00-\\uDD39]|\\uD81A[\\uDC00-\\uDE38\\uDE40-\\uDE5E\\uDE60-\\uDE69\\uDE70-\\uDEBE\\uDEC0-\\uDEC9\\uDED0-\\uDEED\\uDEF0-\\uDEF4\\uDF00-\\uDF36\\uDF40-\\uDF43\\uDF50-\\uDF59\\uDF5B-\\uDF61\\uDF63-\\uDF77\\uDF7D-\\uDF8F]|\\uD81B[\\uDD40-\\uDD6C\\uDD70-\\uDD79\\uDE40-\\uDE96\\uDF00-\\uDF4A\\uDF4F-\\uDF87\\uDF8F-\\uDF9F\\uDFE0\\uDFE1\\uDFE3\\uDFE4\\uDFF0\\uDFF1]|\\uD821[\\uDC00-\\uDFF7]|\\uD823[\\uDC00-\\uDCD5\\uDCFF-\\uDD08]|\\uD82B[\\uDFF0-\\uDFF3\\uDFF5-\\uDFFB\\uDFFD\\uDFFE]|\\uD82C[\\uDC00-\\uDD22\\uDD32\\uDD50-\\uDD52\\uDD55\\uDD64-\\uDD67\\uDD70-\\uDEFB]|\\uD82F[\\uDC00-\\uDC6A\\uDC70-\\uDC7C\\uDC80-\\uDC88\\uDC90-\\uDC99\\uDC9D\\uDC9E]|\\uD833[\\uDCF0-\\uDCF9\\uDF00-\\uDF2D\\uDF30-\\uDF46]|\\uD834[\\uDD65-\\uDD69\\uDD6D-\\uDD72\\uDD7B-\\uDD82\\uDD85-\\uDD8B\\uDDAA-\\uDDAD\\uDE42-\\uDE44\\uDEC0-\\uDED3\\uDEE0-\\uDEF3\\uDF60-\\uDF78]|\\uD835[\\uDC00-\\uDC54\\uDC56-\\uDC9C\\uDC9E\\uDC9F\\uDCA2\\uDCA5\\uDCA6\\uDCA9-\\uDCAC\\uDCAE-\\uDCB9\\uDCBB\\uDCBD-\\uDCC3\\uDCC5-\\uDD05\\uDD07-\\uDD0A\\uDD0D-\\uDD14\\uDD16-\\uDD1C\\uDD1E-\\uDD39\\uDD3B-\\uDD3E\\uDD40-\\uDD44\\uDD46\\uDD4A-\\uDD50\\uDD52-\\uDEA5\\uDEA8-\\uDEC0\\uDEC2-\\uDEDA\\uDEDC-\\uDEFA\\uDEFC-\\uDF14\\uDF16-\\uDF34\\uDF36-\\uDF4E\\uDF50-\\uDF6E\\uDF70-\\uDF88\\uDF8A-\\uDFA8\\uDFAA-\\uDFC2\\uDFC4-\\uDFCB\\uDFCE-\\uDFFF]|\\uD836[\\uDE00-\\uDE36\\uDE3B-\\uDE6C\\uDE75\\uDE84\\uDE9B-\\uDE9F\\uDEA1-\\uDEAF]|\\uD837[\\uDF00-\\uDF1E\\uDF25-\\uDF2A]|\\uD838[\\uDC00-\\uDC06\\uDC08-\\uDC18\\uDC1B-\\uDC21\\uDC23\\uDC24\\uDC26-\\uDC2A\\uDC30-\\uDC6D\\uDC8F\\uDD00-\\uDD2C\\uDD30-\\uDD3D\\uDD40-\\uDD49\\uDD4E\\uDE90-\\uDEAE\\uDEC0-\\uDEF9]|\\uD839[\\uDCD0-\\uDCF9\\uDDD0-\\uDDFA\\uDFE0-\\uDFE6\\uDFE8-\\uDFEB\\uDFED\\uDFEE\\uDFF0-\\uDFFE]|\\uD83A[\\uDC00-\\uDCC4\\uDCC7-\\uDCD6\\uDD00-\\uDD4B\\uDD50-\\uDD59]|\\uD83B[\\uDC71-\\uDCAB\\uDCAD-\\uDCAF\\uDCB1-\\uDCB4\\uDD01-\\uDD2D\\uDD2F-\\uDD3D\\uDE00-\\uDE03\\uDE05-\\uDE1F\\uDE21\\uDE22\\uDE24\\uDE27\\uDE29-\\uDE32\\uDE34-\\uDE37\\uDE39\\uDE3B\\uDE42\\uDE47\\uDE49\\uDE4B\\uDE4D-\\uDE4F\\uDE51\\uDE52\\uDE54\\uDE57\\uDE59\\uDE5B\\uDE5D\\uDE5F\\uDE61\\uDE62\\uDE64\\uDE67-\\uDE6A\\uDE6C-\\uDE72\\uDE74-\\uDE77\\uDE79-\\uDE7C\\uDE7E\\uDE80-\\uDE89\\uDE8B-\\uDE9B\\uDEA1-\\uDEA3\\uDEA5-\\uDEA9\\uDEAB-\\uDEBB]|\\uD83C[\\uDD00-\\uDD0C]|\\uD83E[\\uDFF0-\\uDFF9]|\\uD869[\\uDC00-\\uDEDF\\uDF00-\\uDFFF]|\\uD86D[\\uDC00-\\uDF39\\uDF40-\\uDFFF]|\\uD86E[\\uDC00-\\uDC1D\\uDC20-\\uDFFF]|\\uD873[\\uDC00-\\uDEA1\\uDEB0-\\uDFFF]|\\uD87A[\\uDC00-\\uDFE0\\uDFF0-\\uDFFF]|\\uD87B[\\uDC00-\\uDE5D]|\\uD87E[\\uDC00-\\uDE1D]|\\uD884[\\uDC00-\\uDF4A\\uDF50-\\uDFFF]|\\uD888[\\uDC00-\\uDFAF]|\\uDB40[\\uDD00-\\uDDEF])+$/gi);\n    return matchTyped ? matchTyped[0] : null;\n  }\n  format(slug) {\n    return \"#\".concat(slug);\n  }\n}\nflarum.reg.add('flarum-mentions', 'forum/mentionables/formats/HashMentionFormat', HashMentionFormat);","import _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport AtMentionFormat from './AtMentionFormat';\nimport HashMentionFormat from './HashMentionFormat';\nexport default class MentionFormats {\n  constructor() {\n    _defineProperty(this, \"formats\", [new AtMentionFormat(), new HashMentionFormat()]);\n  }\n  get(symbol) {\n    var _this$formats$find;\n    return (_this$formats$find = this.formats.find(f => f.trigger() === symbol)) != null ? _this$formats$find : null;\n  }\n  mentionable(type) {\n    for (const format of this.formats) {\n      const mentionable = format.getMentionable(type);\n      if (mentionable) return mentionable;\n    }\n    return null;\n  }\n  extend(format) {\n    this.formats.push(new format());\n  }\n}\nflarum.reg.add('flarum-mentions', 'forum/mentionables/formats/MentionFormats', MentionFormats);","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.reg.get('core', 'forum/components/UserPage');","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.reg.get('core', 'common/components/LinkButton');","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.reg.get('core', 'common/extenders');","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.reg.get('core', 'common/models/Post');","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.reg.get('core', 'common/models/User');","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.reg.get('core', 'forum/components/PostsUserPage');","import PostsUserPage from 'flarum/forum/components/PostsUserPage';\n/**\n * The `MentionsUserPage` component shows post which user Mentioned at\n */\nexport default class MentionsUserPage extends PostsUserPage {\n  params(user) {\n    return {\n      filter: {\n        type: 'comment',\n        mentioned: user.id()\n      }\n    };\n  }\n}\nflarum.reg.add('flarum-mentions', 'forum/components/MentionsUserPage', MentionsUserPage);","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.reg.get('core', 'forum/components/Notification');","import app from 'flarum/forum/app';\nimport Notification from 'flarum/forum/components/Notification';\nimport { truncate } from 'flarum/common/utils/string';\nexport default class PostMentionedNotification extends Notification {\n  icon() {\n    return 'fas fa-reply';\n  }\n  href() {\n    const notification = this.attrs.notification;\n    const post = notification.subject();\n    const content = notification.content();\n    return app.route.discussion(post.discussion(), content && content.replyNumber);\n  }\n  content() {\n    const notification = this.attrs.notification;\n    const user = notification.fromUser();\n    return app.translator.trans('flarum-mentions.forum.notifications.post_mentioned_text', {\n      user,\n      count: 1\n    });\n  }\n  excerpt() {\n    return truncate(this.attrs.notification.subject().contentPlain() || '', 200);\n  }\n}\nflarum.reg.add('flarum-mentions', 'forum/components/PostMentionedNotification', PostMentionedNotification);","import app from 'flarum/forum/app';\nimport Notification from 'flarum/forum/components/Notification';\nimport { truncate } from 'flarum/common/utils/string';\nexport default class UserMentionedNotification extends Notification {\n  icon() {\n    return 'fas fa-at';\n  }\n  href() {\n    const post = this.attrs.notification.subject();\n    return app.route.discussion(post.discussion(), post.number());\n  }\n  content() {\n    const user = this.attrs.notification.fromUser();\n    return app.translator.trans('flarum-mentions.forum.notifications.user_mentioned_text', {\n      user\n    });\n  }\n  excerpt() {\n    return truncate(this.attrs.notification.subject().contentPlain(), 200);\n  }\n}\nflarum.reg.add('flarum-mentions', 'forum/components/UserMentionedNotification', UserMentionedNotification);","import app from 'flarum/forum/app';\nimport Notification from 'flarum/forum/components/Notification';\nimport { truncate } from 'flarum/common/utils/string';\nexport default class GroupMentionedNotification extends Notification {\n  icon() {\n    return 'fas fa-at';\n  }\n  href() {\n    const post = this.attrs.notification.subject();\n    return app.route.discussion(post.discussion(), post.number());\n  }\n  content() {\n    const user = this.attrs.notification.fromUser();\n    return app.translator.trans('flarum-mentions.forum.notifications.group_mentioned_text', {\n      user\n    });\n  }\n  excerpt() {\n    return truncate(this.attrs.notification.subject().contentPlain(), 200);\n  }\n}\nflarum.reg.add('flarum-mentions', 'forum/components/GroupMentionedNotification', GroupMentionedNotification);","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.reg.get('core', 'common/query/IGambit');","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.reg.get('core', 'common/app');","import { KeyValueGambit } from 'flarum/common/query/IGambit';\nimport app from 'flarum/common/app';\nexport default class MentionedGambit extends KeyValueGambit {\n  key() {\n    return app.translator.trans('flarum-mentions.lib.gambits.posts.mentioned.key', {}, true);\n  }\n  hint() {\n    return app.translator.trans('flarum-mentions.lib.gambits.posts.mentioned.hint', {}, true);\n  }\n  filterKey() {\n    return 'mentioned';\n  }\n}\nflarum.reg.add('flarum-mentions', 'common/query/posts/MentionedGambit', MentionedGambit);","import Extend from 'flarum/common/extenders';\nimport MentionedGambit from './query/posts/MentionedGambit';\nexport default [new Extend.Search() //\n.gambit('posts', MentionedGambit)];","import Extend from 'flarum/common/extenders';\nimport Post from 'flarum/common/models/Post';\nimport User from 'flarum/common/models/User';\nimport MentionsUserPage from './components/MentionsUserPage';\nimport PostMentionedNotification from './components/PostMentionedNotification';\nimport UserMentionedNotification from './components/UserMentionedNotification';\nimport GroupMentionedNotification from './components/GroupMentionedNotification';\nimport commonExtend from '../common/extend';\nexport default [...commonExtend, new Extend.Routes() //\n.add('user.mentions', '/u/:username/mentions', MentionsUserPage), new Extend.Model(Post) //\n.hasMany('mentionedBy').attribute('mentionedByCount'), new Extend.Notification() //\n.add('postMentioned', PostMentionedNotification).add('userMentioned', UserMentionedNotification).add('groupMentioned', GroupMentionedNotification), new Extend.Model(User) //\n.attribute('canMentionGroups')];","import app from 'flarum/forum/app';\nimport username from 'flarum/common/helpers/username';\nimport extractText from 'flarum/common/utils/extractText';\nexport function filterUserMentions(tag) {\n  let user;\n  if (app.forum.attribute('allowUsernameMentionFormat') && tag.hasAttribute('username')) user = app.store.getBy('users', 'username', tag.getAttribute('username'));else if (tag.hasAttribute('id')) user = app.store.getById('users', tag.getAttribute('id'));\n  if (user) {\n    tag.setAttribute('id', user.id());\n    tag.setAttribute('slug', user.slug());\n    tag.setAttribute('displayname', extractText(username(user)));\n    return true;\n  }\n  tag.invalidate();\n}\nexport function postFilterUserMentions(tag) {\n  tag.setAttribute('deleted', false);\n}\nexport function filterPostMentions(tag) {\n  const post = app.store.getById('posts', tag.getAttribute('id'));\n  if (post) {\n    tag.setAttribute('discussionid', post.discussion().id());\n    tag.setAttribute('number', post.number());\n    tag.setAttribute('displayname', extractText(username(post.user())));\n    return true;\n  }\n}\nexport function postFilterPostMentions(tag) {\n  tag.setAttribute('deleted', false);\n}\nexport function filterGroupMentions(tag) {\n  var _app$session;\n  if ((_app$session = app.session) != null && (_app$session = _app$session.user) != null && _app$session.canMentionGroups()) {\n    const group = app.store.getById('groups', tag.getAttribute('id'));\n    if (group) {\n      tag.setAttribute('groupname', extractText(group.namePlural()));\n      return true;\n    }\n  }\n  tag.invalidate();\n}\nexport function postFilterGroupMentions(tag) {\n  var _app$session2;\n  if ((_app$session2 = app.session) != null && (_app$session2 = _app$session2.user) != null && _app$session2.canMentionGroups()) {\n    const group = app.store.getById('groups', tag.getAttribute('id'));\n    tag.setAttribute('color', group.color());\n    tag.setAttribute('icon', group.icon());\n    tag.setAttribute('deleted', false);\n  }\n}\nexport function filterTagMentions(tag) {\n  if ('flarum-tags' in flarum.extensions) {\n    const model = app.store.getBy('tags', 'slug', tag.getAttribute('slug'));\n    if (model) {\n      tag.setAttribute('id', model.id());\n      tag.setAttribute('tagname', model.name());\n      return true;\n    }\n  }\n  tag.invalidate();\n}\nexport function postFilterTagMentions(tag) {\n  if ('flarum-tags' in flarum.extensions) {\n    const model = app.store.getBy('tags', 'slug', tag.getAttribute('slug'));\n    tag.setAttribute('icon', model.icon());\n    tag.setAttribute('color', model.color());\n    tag.setAttribute('deleted', false);\n  }\n}\nflarum.reg.add('flarum-mentions', 'forum/utils/textFormatter', { filterUserMentions: filterUserMentions,postFilterUserMentions: postFilterUserMentions,filterPostMentions: filterPostMentions,postFilterPostMentions: postFilterPostMentions,filterGroupMentions: filterGroupMentions,postFilterGroupMentions: postFilterGroupMentions,filterTagMentions: filterTagMentions,postFilterTagMentions: postFilterTagMentions, });","import _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nexport default class Mentionables {\n  constructor() {\n    _defineProperty(this, \"formats\", []);\n    _defineProperty(this, \"mentionables\", {});\n  }\n  /**\n   * Register a new mention format.\n   * Must extend MentionFormat and have a unique unused trigger symbol.\n   */\n  format(format) {\n    this.formats.push(format);\n    return this;\n  }\n\n  /**\n   * Register a new mentionable model to a mention format.\n   * Only works if the format has already been registered,\n   *  and the format allows using multiple mentionables.\n   *\n   * @param symbol The trigger symbol of the format to extend (ex: @).\n   * @param mentionable The mentionable instance to register.\n   *                    Must extend MentionableModel.\n   */\n  mentionable(symbol, mentionable) {\n    if (!this.mentionables[symbol]) {\n      this.mentionables[symbol] = [];\n    }\n    this.mentionables[symbol].push(mentionable);\n    return this;\n  }\n  extend(app) {\n    for (const format of this.formats) {\n      app.mentionFormats.extend(format);\n    }\n    for (const symbol in this.mentionables) {\n      const format = app.mentionFormats.get(symbol);\n      if (!format) continue;\n      for (const mentionable of this.mentionables[symbol]) {\n        format.extend(mentionable);\n      }\n    }\n  }\n}\nflarum.reg.add('flarum-mentions', 'forum/extenders/Mentionables', Mentionables);","import { extend, override } from 'flarum/common/extend';\nimport app from 'flarum/forum/app';\nimport { getPlainContent } from 'flarum/common/utils/string';\nimport textContrastClass from 'flarum/common/helpers/textContrastClass';\nimport Post from 'flarum/forum/components/Post';\nimport addPostMentionPreviews from './addPostMentionPreviews';\nimport addMentionedByList from './addMentionedByList';\nimport addPostReplyAction from './addPostReplyAction';\nimport addPostQuoteButton from './addPostQuoteButton';\nimport addComposerAutocomplete from './addComposerAutocomplete';\nimport MentionFormats from './mentionables/formats/MentionFormats';\nimport UserPage from 'flarum/forum/components/UserPage';\nimport LinkButton from 'flarum/common/components/LinkButton';\napp.mentionFormats = new MentionFormats();\nexport { default as extend } from './extend';\napp.initializers.add('flarum-mentions', () => {\n  // For every mention of a post inside a post's content, set up a hover handler\n  // that shows a preview of the mentioned post.\n  addPostMentionPreviews();\n\n  // In the footer of each post, show information about who has replied (i.e.\n  // who the post has been mentioned by).\n  addMentionedByList();\n\n  // Add a 'reply' control to the footer of each post. When clicked, it will\n  // open up the composer and add a post mention to its contents.\n  addPostReplyAction();\n\n  // Show a Quote button when Post text is selected\n  addPostQuoteButton();\n\n  // After typing '@' in the composer, show a dropdown suggesting a bunch of\n  // posts or users that the user could mention.\n  addComposerAutocomplete();\n\n  // Add notification preferences.\n  extend('flarum/forum/components/NotificationGrid', 'notificationTypes', function (items) {\n    items.add('postMentioned', {\n      name: 'postMentioned',\n      icon: 'fas fa-reply',\n      label: app.translator.trans('flarum-mentions.forum.settings.notify_post_mentioned_label')\n    });\n    items.add('userMentioned', {\n      name: 'userMentioned',\n      icon: 'fas fa-at',\n      label: app.translator.trans('flarum-mentions.forum.settings.notify_user_mentioned_label')\n    });\n    items.add('groupMentioned', {\n      name: 'groupMentioned',\n      icon: 'fas fa-at',\n      label: app.translator.trans('flarum-mentions.forum.settings.notify_group_mentioned_label')\n    });\n  });\n\n  // Add mentions tab in user profile\n  extend(UserPage.prototype, 'navItems', function (items) {\n    const user = this.user;\n    items.add('mentions', m(LinkButton, {\n      href: app.route('user.mentions', {\n        username: user.slug()\n      }),\n      name: \"mentions\",\n      icon: \"fas fa-at\"\n    }, app.translator.trans('flarum-mentions.forum.user.mentions_link')), 80);\n  });\n\n  // Remove post mentions when rendering post previews.\n  getPlainContent.removeSelectors.push('a.PostMention');\n\n  // Apply color contrast fix on group mentions.\n  extend(Post.prototype, 'oncreate', function () {\n    this.$('.GroupMention--colored, .TagMention--colored').each(function () {\n      this.classList.add(textContrastClass(getComputedStyle(this).getPropertyValue('--color')));\n    });\n  });\n\n  // Auto scope the search to the current user mentioned posts.\n  override('flarum/forum/components/SearchModal', 'defaultActiveSource', function (original) {\n    const orig = original();\n    if (!orig && app.current.data.routeName && app.current.data.routeName.includes('user.mentions') && app.current.data.user) {\n      return 'posts';\n    }\n    return orig;\n  });\n  extend('flarum/forum/components/SearchModal', 'defaultFilters', function (filters) {\n    if (app.current.data.routeName && app.current.data.routeName.includes('user.mentions') && app.current.data.user) {\n      filters.posts.mentioned = app.current.data.user.username();\n    }\n  });\n});\nexport * from './utils/textFormatter';\nimport './forum';","import { extend } from 'flarum/common/extend';\nimport CommentPost from 'flarum/forum/components/CommentPost';\nimport PostPreview from 'flarum/forum/components/PostPreview';\nimport LoadingIndicator from 'flarum/common/components/LoadingIndicator';\nexport default function addPostMentionPreviews() {\n  function addPreviews() {\n    const contentHtml = this.attrs.post.contentHtml();\n    if (contentHtml === this.oldPostContentHtml || this.isEditing()) return;\n    this.oldPostContentHtml = contentHtml;\n    const parentPost = this.attrs.post;\n    const $parentPost = this.$();\n    this.$().on('click', '.UserMention:not(.UserMention--deleted), .PostMention:not(.PostMention--deleted), .TagMention:not(.TagMention--deleted)', function (e) {\n      m.route.set(this.getAttribute('href'));\n      e.preventDefault();\n    });\n    this.$('.PostMention:not(.PostMention--deleted)').each(function () {\n      const $this = $(this);\n      const id = $this.data('id');\n      let timeout;\n\n      // Wrap the mention link in a wrapper element so that we can insert a\n      // preview popup as its sibling and relatively position it.\n      const $preview = $('<ul class=\"Dropdown-menu PostMention-preview fade\"/>');\n      $parentPost.append($preview);\n      const getPostElement = () => {\n        return $(\".PostStream-item[data-id=\\\"\".concat(id, \"\\\"]\"));\n      };\n      const showPreview = () => {\n        // When the user hovers their mouse over the mention, look for the\n        // post that it's referring to in the stream, and determine if it's\n        // in the viewport. If it is, we will \"pulsate\" it.\n        const $post = getPostElement();\n        let visible = false;\n        if ($post.length) {\n          const top = $post.offset().top;\n          const scrollTop = window.pageYOffset;\n          if (top > scrollTop && top + $post.height() < scrollTop + $(window).height()) {\n            $post.addClass('pulsate');\n            visible = true;\n          }\n        }\n\n        // Otherwise, we will show a popup preview of the post. If the post\n        // hasn't yet been loaded, we will need to do that.\n        if (!visible) {\n          // Position the preview so that it appears above the mention.\n          // (The offsetParent should be .Post-body.)\n          const positionPreview = () => {\n            const previewHeight = $preview.outerHeight(true);\n            let offset = 0;\n\n            // If the preview goes off the top of the viewport, reposition it to\n            // be below the mention.\n            if ($this.offset().top - previewHeight < $(window).scrollTop() + $('#header').outerHeight()) {\n              offset += $this.outerHeight(true);\n            } else {\n              offset -= previewHeight;\n            }\n            $preview.show().css('top', $this.offset().top - $parentPost.offset().top + offset).css('left', $this.offsetParent().offset().left - $parentPost.offset().left).css('max-width', $this.offsetParent().width());\n          };\n          const showPost = post => {\n            const discussion = post.discussion();\n            m.render($preview[0], [discussion !== parentPost.discussion() && m(\"li\", null, m(\"span\", {\n              className: \"PostMention-preview-discussion\"\n            }, discussion.title())), m(\"li\", null, m(PostPreview, {\n              post: post\n            }))]);\n            positionPreview();\n          };\n          const post = app.store.getById('posts', id);\n          if (post && post.discussion()) {\n            showPost(post);\n          } else {\n            m.render($preview[0], m(LoadingIndicator, null));\n            app.store.find('posts', id).then(showPost);\n            positionPreview();\n          }\n          setTimeout(() => $preview.off('transitionend').addClass('in'));\n        }\n      };\n      const hidePreview = () => {\n        getPostElement().removeClass('pulsate');\n        if ($preview.hasClass('in')) {\n          $preview.removeClass('in').one('transitionend', () => $preview.hide());\n        }\n      };\n\n      // On a touch (mobile) device we cannot hover the link to reveal the preview.\n      // Instead we cancel the navigation so that a click reveals the preview.\n      // Users can then click on the preview to go to the post if desired.\n      $this.on('touchend', e => {\n        if (e.cancelable) {\n          e.preventDefault();\n        }\n      });\n      $this.add($preview).hover(() => {\n        clearTimeout(timeout);\n        timeout = setTimeout(showPreview, 250);\n      }, () => {\n        clearTimeout(timeout);\n        getPostElement().removeClass('pulsate');\n        timeout = setTimeout(hidePreview, 250);\n      }).on('touchend', e => {\n        showPreview();\n        e.stopPropagation();\n      });\n      $(document).on('touchend', hidePreview);\n    });\n  }\n  extend(CommentPost.prototype, 'oncreate', addPreviews);\n  extend(CommentPost.prototype, 'onupdate', addPreviews);\n}","import app from 'flarum/forum/app';\nimport { extend } from 'flarum/common/extend';\nimport CommentPost from 'flarum/forum/components/CommentPost';\nimport Link from 'flarum/common/components/Link';\nimport PostPreview from 'flarum/forum/components/PostPreview';\nimport punctuateSeries from 'flarum/common/helpers/punctuateSeries';\nimport username from 'flarum/common/helpers/username';\nimport Icon from 'flarum/common/components/Icon';\nimport Button from 'flarum/common/components/Button';\nimport MentionedByModal from './components/MentionedByModal';\nexport default function addMentionedByList() {\n  function hidePreview() {\n    this.$('.Post-mentionedBy-preview').removeClass('in').one('transitionend', function () {\n      $(this).hide();\n    });\n  }\n  extend(CommentPost.prototype, 'oncreate', function () {\n    let timeout;\n    const post = this.attrs.post;\n    const replies = post.mentionedBy();\n    if (replies && replies.length) {\n      const $preview = $('<ul class=\"Dropdown-menu Post-mentionedBy-preview fade\"/>');\n      this.$().append($preview);\n      const $parentPost = this.$();\n      const $this = this.$('.Post-mentionedBy');\n      const showPreview = () => {\n        if (!$preview.hasClass('in') && $preview.is(':visible')) return;\n\n        // When the user hovers their mouse over the list of people who have\n        // replied to the post, render a list of reply previews into a\n        // popup.\n        m.render($preview[0], m('[', null, replies.map(reply => m(\"li\", {\n          \"data-number\": reply.number()\n        }, m(PostPreview, {\n          post: reply,\n          onclick: hidePreview.bind(this)\n        }))), replies.length < post.mentionedByCount() && m(\"li\", {\n          className: \"Post-mentionedBy-preview-more\"\n        }, m(Button, {\n          className: \"PostPreview Button\",\n          onclick: () => {\n            hidePreview.call(this);\n            app.modal.show(MentionedByModal, {\n              post\n            });\n          }\n        }, m(\"span\", {\n          className: \"PostPreview-content\"\n        }, m(\"span\", {\n          className: \"PostPreview-badge Avatar\"\n        }, m(Icon, {\n          name: 'fas fa-reply-all'\n        })), m(\"span\", null, app.translator.trans('flarum-mentions.forum.post.mentioned_by_more_text', {\n          count: post.mentionedByCount() - replies.length\n        })))))));\n        $preview.show().css('top', $this.offset().top - $parentPost.offset().top + $this.outerHeight(true)).css('left', $this.offsetParent().offset().left - $parentPost.offset().left).css('max-width', $parentPost.width());\n        setTimeout(() => $preview.off('transitionend').addClass('in'));\n      };\n      $this.add($preview).hover(() => {\n        clearTimeout(timeout);\n        timeout = setTimeout(showPreview, 250);\n      }, () => {\n        clearTimeout(timeout);\n        timeout = setTimeout(hidePreview, 250);\n      });\n\n      // Whenever the user hovers their mouse over a particular name in the\n      // list of repliers, highlight the corresponding post in the preview\n      // popup.\n      this.$().find('.Post-mentionedBy-summary a').hover(function () {\n        $preview.find('[data-number=\"' + $(this).data('number') + '\"]').addClass('active');\n      }, function () {\n        $preview.find('[data-number]').removeClass('active');\n      });\n    }\n  });\n  extend(CommentPost.prototype, 'footerItems', function (items) {\n    const post = this.attrs.post;\n    const replies = post.mentionedBy();\n    if (replies && replies.length) {\n      const users = [];\n      const repliers = replies.sort(reply => reply.user() === app.session.user ? -1 : 0).filter(reply => {\n        const user = reply.user();\n        if (users.indexOf(user) === -1) {\n          users.push(user);\n          return true;\n        }\n      });\n      const limit = 4;\n      const overLimit = post.mentionedByCount() > limit;\n\n      // Create a list of unique users who have replied. So even if a user has\n      // replied twice, they will only be in this array once.\n      const names = repliers.slice(0, overLimit ? limit - 1 : limit).map(reply => {\n        const user = reply.user();\n        return m(Link, {\n          href: app.route.post(reply),\n          onclick: hidePreview.bind(this),\n          \"data-number\": reply.number()\n        }, app.session.user === user ? app.translator.trans('flarum-mentions.forum.post.you_text') : username(user));\n      });\n\n      // If there are more users that we've run out of room to display, add a \"x\n      // others\" name to the end of the list. Clicking on it will display a modal\n      // with a full list of names.\n      if (overLimit) {\n        const count = post.mentionedByCount() - names.length;\n        names.push(app.translator.trans('flarum-mentions.forum.post.others_text', {\n          count\n        }));\n      }\n      items.add('replies', m(\"div\", {\n        className: \"Post-mentionedBy\"\n      }, m(\"span\", {\n        className: \"Post-mentionedBy-summary\"\n      }, m(Icon, {\n        name: 'fas fa-reply'\n      }), app.translator.trans(\"flarum-mentions.forum.post.mentioned_by\".concat(repliers[0].user() === app.session.user ? '_self' : '', \"_text\"), {\n        count: names.length,\n        users: punctuateSeries(names)\n      }))));\n    }\n  });\n}","import app from 'flarum/forum/app';\nimport { extend } from 'flarum/common/extend';\nimport Button from 'flarum/common/components/Button';\nimport CommentPost from 'flarum/forum/components/CommentPost';\nimport reply from './utils/reply';\nexport default function addPostReplyAction() {\n  extend(CommentPost.prototype, 'actionItems', function (items) {\n    const post = this.attrs.post;\n    if (post.isHidden() || app.session.user && !post.discussion().canReply()) return;\n    items.add('reply', m(Button, {\n      className: \"Button Button--link\",\n      onclick: () => reply(post)\n    }, app.translator.trans('flarum-mentions.forum.post.reply_link')));\n  });\n}","import app from 'flarum/forum/app';\nimport { extend } from 'flarum/common/extend';\nimport CommentPost from 'flarum/forum/components/CommentPost';\nimport PostQuoteButton from './fragments/PostQuoteButton';\nimport selectedText from './utils/selectedText';\nexport default function addPostQuoteButton() {\n  extend(CommentPost.prototype, 'oncreate', function () {\n    const post = this.attrs.post;\n    if (post.isHidden() || app.session.user && !post.discussion().canReply()) return;\n    const $postBody = this.$('.Post-body');\n\n    // Wrap the quote button in a wrapper element so that we can render\n    // button into it.\n    const $container = $('<div class=\"Post-quoteButtonContainer\"></div>');\n    const button = new PostQuoteButton(post);\n    const handler = function (e) {\n      setTimeout(() => {\n        const content = selectedText($postBody);\n        if (content) {\n          button.content = content;\n          m.render($container[0], button.render());\n          const rects = window.getSelection().getRangeAt(0).getClientRects();\n          const firstRect = rects[0];\n          if (e.clientY < firstRect.bottom && e.clientX - firstRect.right < firstRect.left - e.clientX) {\n            button.showStart(firstRect.left, firstRect.top);\n          } else {\n            const lastRect = rects[rects.length - 1];\n            button.showEnd(lastRect.right, lastRect.bottom);\n          }\n        }\n      }, 1);\n    };\n    this.$().after($container).on('mouseup', handler);\n    if ('ontouchstart' in window) {\n      document.addEventListener('selectionchange', handler, false);\n    }\n  });\n}","import app from 'flarum/forum/app';\nimport { extend } from 'flarum/common/extend';\nimport TextEditorButton from 'flarum/common/components/TextEditorButton';\nimport KeyboardNavigatable from 'flarum/common/utils/KeyboardNavigatable';\nimport AutocompleteReader from 'flarum/common/utils/AutocompleteReader';\nimport { throttle } from 'flarum/common/utils/throttleDebounce';\nimport AutocompleteDropdown from './fragments/AutocompleteDropdown';\nimport MentionableModels from './mentionables/MentionableModels';\nexport default function addComposerAutocomplete() {\n  extend('flarum/common/components/TextEditor', 'onbuild', function () {\n    this.mentionsDropdown = new AutocompleteDropdown();\n    this.searchMentions = throttle(250, (mentionables, buildSuggestions) => mentionables.search().then(buildSuggestions));\n    const $editor = this.$('.TextEditor-editor').wrap('<div class=\"ComposerBody-mentionsWrapper\"></div>');\n    this.navigator = new KeyboardNavigatable();\n    this.navigator.when(() => this.mentionsDropdown.active).onUp(() => this.mentionsDropdown.navigate(-1)).onDown(() => this.mentionsDropdown.navigate(1)).onSelect(this.mentionsDropdown.complete.bind(this.mentionsDropdown)).onCancel(this.mentionsDropdown.hide.bind(this.mentionsDropdown)).bindTo($editor);\n    $editor.after($('<div class=\"ComposerBody-mentionsDropdownContainer\"></div>'));\n  });\n  extend('flarum/common/components/TextEditor', 'buildEditorParams', function (params) {\n    let matchTyped;\n    const suggestionsInputListener = () => {\n      const selection = this.attrs.composer.editor.getSelectionRange();\n      const cursor = selection[0];\n      if (selection[1] - cursor > 0) return;\n      let activeFormat = null;\n      const autocompleteReader = new AutocompleteReader(character => !!(activeFormat = app.mentionFormats.get(character)));\n      const autocompleting = autocompleteReader.check(this.attrs.composer.editor.getLastNChars(30), cursor, /\\S+/);\n      const mentionsDropdown = this.mentionsDropdown;\n      let mentionables = new MentionableModels({\n        onmouseenter: function () {\n          mentionsDropdown.setIndex($(this).parent().index());\n        },\n        onclick: replacement => {\n          this.attrs.composer.editor.replaceBeforeCursor(autocompleting.absoluteStart - 1, replacement + ' ');\n          this.mentionsDropdown.hide();\n        }\n      });\n      this.mentionsDropdown.hide();\n      this.mentionsDropdown.active = false;\n      if (autocompleting) {\n        mentionables.init(activeFormat.makeMentionables());\n        matchTyped = activeFormat.queryFromTyped(autocompleting.typed);\n        if (!matchTyped) return;\n        mentionables.typed = matchTyped;\n        const buildSuggestions = () => {\n          // If the user has started to type a mention,\n          // then suggest models matching.\n          const suggestions = mentionables.buildSuggestions();\n          if (suggestions.length) {\n            this.mentionsDropdown.items = suggestions;\n            m.render(this.$('.ComposerBody-mentionsDropdownContainer')[0], this.mentionsDropdown.render());\n            this.mentionsDropdown.show();\n            const coordinates = this.attrs.composer.editor.getCaretCoordinates(autocompleting.absoluteStart);\n            const width = this.mentionsDropdown.$().outerWidth();\n            const height = this.mentionsDropdown.$().outerHeight();\n            const parent = this.mentionsDropdown.$().offsetParent();\n            let left = coordinates.left;\n            let top = coordinates.top + 15;\n\n            // Keep the dropdown inside the editor.\n            if (top + height > parent.height()) {\n              top = coordinates.top - height - 15;\n            }\n            if (left + width > parent.width()) {\n              left = parent.width() - width;\n            }\n\n            // Prevent the dropdown from going off screen on mobile\n            top = Math.max(-(parent.offset().top - $(document).scrollTop()), top);\n            left = Math.max(-parent.offset().left, left);\n            this.mentionsDropdown.show(left, top);\n          } else {\n            this.mentionsDropdown.active = false;\n            this.mentionsDropdown.hide();\n          }\n        };\n        this.mentionsDropdown.active = true;\n        buildSuggestions();\n        this.mentionsDropdown.setIndex(0);\n        this.mentionsDropdown.$().scrollTop(0);\n        this.searchMentions(mentionables, buildSuggestions);\n      }\n    };\n    params.inputListeners.push(suggestionsInputListener);\n  });\n  extend('flarum/common/components/TextEditor', 'toolbarItems', function (items) {\n    items.add('mention', m(TextEditorButton, {\n      onclick: () => this.attrs.composer.editor.insertAtCursor(' @'),\n      icon: \"fas fa-at\"\n    }, app.translator.trans('flarum-mentions.forum.composer.mention_tooltip')));\n  });\n}"],"names":["__webpack_require__","module","getter","__esModule","d","a","exports","definition","key","o","Object","defineProperty","enumerable","get","obj","prop","prototype","hasOwnProperty","call","Symbol","toStringTag","value","flarum","reg","_typeof","iterator","constructor","_defineProperty","e","r","t","i","toPrimitive","TypeError","String","toPropertyKey","configurable","writable","ownKeys","keys","getOwnPropertySymbols","filter","getOwnPropertyDescriptor","push","apply","_objectSpread","arguments","length","forEach","getOwnPropertyDescriptors","defineProperties","MentionedByModalState","params","page","limit","super","type","add","MentionedByModal","oninit","vnode","this","state","mentionedPost","attrs","post","id","sort","refresh","className","title","trans","content","m","isInitialLoading","getPages","map","items","reply","number","onclick","close","hasNext","loadNext","loading","isLoadingNext","insertMention","composer","quote","Promise","resolve","mention","mentionable","replacement","fields","body","originalContent","cursorPosition","editor","getSelectionRange","preceding","slice","precedingNewlines","match","insertAtCursor","Array","join","trim","replace","bodyMatches","discussion","then","PostQuoteButton","view","name","show","left","top","$this","$","parentOffset","offsetParent","offset","css","hideHandler","hide","bind","document","on","showStart","window","scrollTop","outerHeight","showEnd","right","bottom","outerWidth","off","selectedText","selection","getSelection","isCollapsed","range","getRangeAt","parent","commonAncestorContainer","contains","clone","append","cloneContents","find","replaceWith","alt","concat","src","innerText","href","text","AutocompleteDropdown","item","active","navigate","delta","keyWasJustPressed","setIndex","index","clearTimeout","keyWasJustPressedTimeout","setTimeout","complete","eq","click","scrollToItem","$dropdown","$items","rangedIndex","$item","removeClass","addClass","dropdownScroll","dropdownTop","dropdownBottom","itemTop","itemBottom","parseInt","stop","animate","_objectWithoutProperties","n","indexOf","objectWithoutPropertiesLoose","propertyIsEnumerable","_excluded","MentionsDropdownItem","_this$attrs","assign","children","MentionableModels","dropdownItemAttrs","async","typed","typedLower","toLowerCase","searched","includes","mentionables","model","search","results","has","set","init","Map","initialResults","result","matches","_this$typed","makeSuggestion","suggestion","_this$dropdownItemAtt","buildSuggestions","suggestions","enabled","from","values","max","maxStoreMatchedResults","splice","dropdownItem","MentionFormat","makeMentionables","_this$instances","instances","Mentionable","getMentionable","_this$makeMentionable","extend","extendable","Error","MentionableModel","format","getDeletedUserText","getCleanDisplayName","user","useDisplayName","displayName","username","UserMention","all","attribute","cleanText","some","substr","q","PostMention","composerAttrs","composerPost","posts","contentType","b","createdAt","getTime","_model$contentPlain","truncate","contentPlain","userMentionable","GroupMention","g","group","namePlural","groupName","color","icon","nameSingular","_app$session$user$can","_app$session","canMentionGroups","AtMentionFormat","trigger","queryFromTyped","matchTyped","char","simple","safe","TagMention","tag","slug","tagName","extensions","HashMentionFormat","MentionFormats","symbol","_this$formats$find","formats","f","MentionsUserPage","mentioned","PostMentionedNotification","notification","subject","replyNumber","fromUser","count","excerpt","UserMentionedNotification","GroupMentionedNotification","MentionedGambit","KeyValueGambit","hint","filterKey","gambit","hasMany","filterUserMentions","hasAttribute","getBy","getAttribute","getById","setAttribute","invalidate","postFilterUserMentions","filterPostMentions","postFilterPostMentions","filterGroupMentions","postFilterGroupMentions","_app$session2","filterTagMentions","postFilterTagMentions","app","mentionFormats","addPreviews","contentHtml","oldPostContentHtml","isEditing","parentPost","$parentPost","route","preventDefault","each","data","timeout","$preview","getPostElement","showPreview","$post","visible","pageYOffset","height","positionPreview","previewHeight","width","showPost","render","store","hidePreview","hasClass","one","cancelable","hover","stopPropagation","addPostMentionPreviews","replies","mentionedBy","is","mentionedByCount","users","repliers","overLimit","names","addMentionedByList","isHidden","canReply","$postBody","$container","button","handler","rects","getClientRects","firstRect","clientY","clientX","lastRect","after","addEventListener","mentionsDropdown","searchMentions","throttle","$editor","wrap","navigator","when","onUp","onDown","onSelect","onCancel","bindTo","inputListeners","cursor","activeFormat","autocompleting","character","check","getLastNChars","onmouseenter","replaceBeforeCursor","absoluteStart","coordinates","getCaretCoordinates","Math","label","getPlainContent","removeSelectors","classList","getComputedStyle","getPropertyValue","override","original","orig","routeName","filters"],"ignoreList":[],"sourceRoot":""}